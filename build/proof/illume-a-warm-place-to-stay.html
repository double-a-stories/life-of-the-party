<html>
<head>
<title>A Warm Place to Stay (Illuminated)</title>
<style type="text/css">
html { box-sizing: border-box;}
*, *:before, *:after { box-sizing: inherit;}

html, body {
margin: 0px;
padding: 0px;
font-family:'Open Sans', 'Source Code Pro', 'Deja Vu Sans', 'Arial', sans-serif;
font-size: 12pt;
}

input {
font-family:'Open Sans', 'Source Code Pro', 'Deja Vu Sans', 'Arial', sans-serif;
}

#header {
border: 1px solid #990;
width: 100%;
height: 35px;
font-size: 12pt;
font-weight: bold;
background: #36c;
color: #eef;
padding: 5px;
}

#workspace {
position: absolute;
top: 35px;
left: 0;
right: 0;
bottom: 25px;
}

#sidebar {
position: absolute;
left: 0;
top: 0px;
bottom: 0px;
width: 250px;
border-right: 1px solid #999;
background: #eee;
}
#sidebar span {
display: inline-block;
width: 100%;
text-decoration: none;
color: #009;
cursor: pointer;
}
#sidebar span:hover {
background: #ffc;
text-decoration: underline;
}
#links {
height: 120px;
font-size: 10pt;
padding: 4px;
}
#passageListHeader {
width: 100%;
height: 25px;
padding: 0px;
}
#filter {
font-size: 10pt;
font-weight: bold;
margin: 0px;
padding: 0px;
width: 100%;
height: 25px;
border: 0px;
border-top: 1px solid #999;
border-bottom: 1px solid #999;
background: #ddf;
}
#filter:focus {
outline: none;
box-shadow: none;
}
#passageListContent {
position: absolute;
top: 145px;
bottom: 0;
left: 0;
width: 250px;
overflow: auto;
padding: 4px;
font-size: 10pt;
}
.flag {
display: inline-block;
float: right;
width: 15px;
height: 15px;
font-size: 7pt;
text-align: center;
font-weight: bold;
margin: 2px 2px 0px 0px;
}
.reviewed {
border: 1px solid #090;
background: #bfb;
border-radius: 5px;
}
.changed {
border: 1px solid #900;
background: #fbb;
border-radius: 7px;
}


#contentArea { 
height: 99%;
margin-left: 250px;
padding: 5px 5px 5px 10px;
overflow: auto;
}


#generalOutput {
display: none;
}
#generalHeader {
height: 35px;
padding: 2px;
border-bottom: 1px solid #999;
}
#generalTitle {
display: inline-block;
font-weight: bold;
font-size: 16pt;
}

.infoTile {
display: inline-block;
float: left;
overflow: auto;
border: 1px solid #999;
border-radius: 5px;
margin: 10px 10px 0px 0px;
}
.tile1x1 {
width: 200px;
height: 250px;
}
.tile2x1 {
width: 410px;
height: 250px;
}
.tile1x2 {
width: 200px;
height: 510px;
}
.tile2x2 {
width: 410px;
height: 510px;
}
.infoTile .title {
background: #ddf;
display: block;
font-weight: bold;
border-bottom: 1px solid #999;
padding: 1px 2px 1px 4px;
}

.infoTile .content {
font-size: 8pt;
}
.infoTile p {
margin: 0px;
padding: 4px;
line-height: 150%;
}
.infoTile table {
border-spacing: 0px;
width: 100%;
font-size: 8pt;
}
.infoTile table tr.header td {
background: #eee;
border-bottom: 1px solid #999;
font-weight: bold;
}
.infoTile table td {
padding: 2px;
margin: 0px;
text-align: right;
padding-right: 4px;
border-left: 1px solid #999;
}
.infoTile table td:nth-of-type(1) {
border-left: 0px;
padding-left: 4px;
text-align: left;
}
.infoTile span.link {
display: inline-block;
width: 100%;
text-decoration: none;
color: #009;
cursor: pointer;
}
.infoTile span.link:hover {
background: #ffc;
text-decoration: underline;
}



#passageViewer {
display: none;
}
#passageHeader {
height: 35px;
padding: 2px;
border-bottom: 1px solid #999;
}
#passageTitle {
display: inline-block;
font-weight: bold;
font-size: 16pt;
}
#passageTags {
position: absolute;
top: 0;
display: inline-block;
padding: 0px 0px 0px 15px;
margin-top: 10px;
}

#passageControls {
display: block;
font-size: 9pt;
border-bottom: 1px solid #999;
background: #eee;
height: 25px;
padding: 2px 5px 1px 5px;
}
#passageControls input {
font-size: 8pt;
}
#dirtyControls {
float: right;
display: none;
}
#reviewedControls {
display: none;
}
#unreviewedControls {
display: none;
}

#passageContent {
position: absolute;
top: 60px;
bottom: 0;
left: 260px;
right: 0;
}
/* #editor {
margin-top: 5px;
font-size: 14pt;
position: absolute;
top: 0;
bottom: 0;
left: 0;
width: 100%;
resize: vertical;
margin-bottom: 400px;
border: 0px;
} */
#editor {
font-size: 14pt;
width: 100%;
height: 99%;
resize: none;
}
#editorCorral {
margin-top: 5px;
position: absolute;
top: 0;
bottom: 0;
left: 0;
width: 100%;
border: 0px;
}

#editor:focus {
outline: 0px;
}
#changeViewer {
font-size: 10pt;
white-space: pre-wrap;
display: none;
border-top: 1px dashed #999;
padding-top: 10px;
position: absolute;
bottom: 0;
left: 0;
right: 0;
width: 100%;
height: 300px;
overflow: auto;
}

.tag {
border: 1px solid #cc9;
padding: 1px 5px 1px 5px;
margin-right: 4px;
margin-bottom: 3px;
background: #fea;
color: #660;
border-radius: 3px;
font-size: 9pt;
cursor: pointer;
}

ins {
background: #9f9;
}

del {
background: #f99;
}

#footer {
position: absolute;
height: 25px;
bottom: 0;
left: 0;
right: 0;
font-weight: bold;
background: #36c;
color: #eef;
font-size: 12pt;
padding: 1px 4px 0px 4px;
}
#footer input {
font-weight: bold;
font-size: 8pt;
}
#footerLeft {
}
#footerRight {
float: right;
}
</style>
<script type="text/javascript">
/**
 * Diff Match and Patch
 *
 * Copyright 2006 Google Inc.
 * http://code.google.com/p/google-diff-match-patch/
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(){function diff_match_patch(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=0.5;this.Match_Distance=1E3;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=32}
diff_match_patch.prototype.diff_main=function(a,b,c,d){"undefined"==typeof d&&(d=0>=this.Diff_Timeout?Number.MAX_VALUE:(new Date).getTime()+1E3*this.Diff_Timeout);if(null==a||null==b)throw Error("Null input. (diff_main)");if(a==b)return a?[[0,a]]:[];"undefined"==typeof c&&(c=!0);var e=c,f=this.diff_commonPrefix(a,b);c=a.substring(0,f);a=a.substring(f);b=b.substring(f);var f=this.diff_commonSuffix(a,b),g=a.substring(a.length-f);a=a.substring(0,a.length-f);b=b.substring(0,b.length-f);a=this.diff_compute_(a,
b,e,d);c&&a.unshift([0,c]);g&&a.push([0,g]);this.diff_cleanupMerge(a);return a};
diff_match_patch.prototype.diff_compute_=function(a,b,c,d){if(!a)return[[1,b]];if(!b)return[[-1,a]];var e=a.length>b.length?a:b,f=a.length>b.length?b:a,g=e.indexOf(f);return-1!=g?(c=[[1,e.substring(0,g)],[0,f],[1,e.substring(g+f.length)]],a.length>b.length&&(c[0][0]=c[2][0]=-1),c):1==f.length?[[-1,a],[1,b]]:(e=this.diff_halfMatch_(a,b))?(f=e[0],a=e[1],g=e[2],b=e[3],e=e[4],f=this.diff_main(f,g,c,d),c=this.diff_main(a,b,c,d),f.concat([[0,e]],c)):c&&100<a.length&&100<b.length?this.diff_lineMode_(a,b,
d):this.diff_bisect_(a,b,d)};
diff_match_patch.prototype.diff_lineMode_=function(a,b,c){var d=this.diff_linesToChars_(a,b);a=d.chars1;b=d.chars2;d=d.lineArray;a=this.diff_main(a,b,!1,c);this.diff_charsToLines_(a,d);this.diff_cleanupSemantic(a);a.push([0,""]);for(var e=d=b=0,f="",g="";b<a.length;){switch(a[b][0]){case 1:e++;g+=a[b][1];break;case -1:d++;f+=a[b][1];break;case 0:if(1<=d&&1<=e){a.splice(b-d-e,d+e);b=b-d-e;d=this.diff_main(f,g,!1,c);for(e=d.length-1;0<=e;e--)a.splice(b,0,d[e]);b+=d.length}d=e=0;g=f=""}b++}a.pop();return a};
diff_match_patch.prototype.diff_bisect_=function(a,b,c){for(var d=a.length,e=b.length,f=Math.ceil((d+e)/2),g=f,h=2*f,j=Array(h),i=Array(h),k=0;k<h;k++)j[k]=-1,i[k]=-1;j[g+1]=0;i[g+1]=0;for(var k=d-e,q=0!=k%2,r=0,t=0,p=0,w=0,v=0;v<f&&!((new Date).getTime()>c);v++){for(var n=-v+r;n<=v-t;n+=2){var l=g+n,m;m=n==-v||n!=v&&j[l-1]<j[l+1]?j[l+1]:j[l-1]+1;for(var s=m-n;m<d&&s<e&&a.charAt(m)==b.charAt(s);)m++,s++;j[l]=m;if(m>d)t+=2;else if(s>e)r+=2;else if(q&&(l=g+k-n,0<=l&&l<h&&-1!=i[l])){var u=d-i[l];if(m>=
u)return this.diff_bisectSplit_(a,b,m,s,c)}}for(n=-v+p;n<=v-w;n+=2){l=g+n;u=n==-v||n!=v&&i[l-1]<i[l+1]?i[l+1]:i[l-1]+1;for(m=u-n;u<d&&m<e&&a.charAt(d-u-1)==b.charAt(e-m-1);)u++,m++;i[l]=u;if(u>d)w+=2;else if(m>e)p+=2;else if(!q&&(l=g+k-n,0<=l&&(l<h&&-1!=j[l])&&(m=j[l],s=g+m-l,u=d-u,m>=u)))return this.diff_bisectSplit_(a,b,m,s,c)}}return[[-1,a],[1,b]]};
diff_match_patch.prototype.diff_bisectSplit_=function(a,b,c,d,e){var f=a.substring(0,c),g=b.substring(0,d);a=a.substring(c);b=b.substring(d);f=this.diff_main(f,g,!1,e);e=this.diff_main(a,b,!1,e);return f.concat(e)};
diff_match_patch.prototype.diff_linesToChars_=function(a,b){function c(a){for(var b="",c=0,f=-1,g=d.length;f<a.length-1;){f=a.indexOf("\\n",c);-1==f&&(f=a.length-1);var r=a.substring(c,f+1),c=f+1;(e.hasOwnProperty?e.hasOwnProperty(r):void 0!==e[r])?b+=String.fromCharCode(e[r]):(b+=String.fromCharCode(g),e[r]=g,d[g++]=r)}return b}var d=[],e={};d[0]="";var f=c(a),g=c(b);return{chars1:f,chars2:g,lineArray:d}};
diff_match_patch.prototype.diff_charsToLines_=function(a,b){for(var c=0;c<a.length;c++){for(var d=a[c][1],e=[],f=0;f<d.length;f++)e[f]=b[d.charCodeAt(f)];a[c][1]=e.join("")}};diff_match_patch.prototype.diff_commonPrefix=function(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;c<e;)a.substring(f,e)==b.substring(f,e)?f=c=e:d=e,e=Math.floor((d-c)/2+c);return e};
diff_match_patch.prototype.diff_commonSuffix=function(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;c<e;)a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f)?f=c=e:d=e,e=Math.floor((d-c)/2+c);return e};
diff_match_patch.prototype.diff_commonOverlap_=function(a,b){var c=a.length,d=b.length;if(0==c||0==d)return 0;c>d?a=a.substring(c-d):c<d&&(b=b.substring(0,c));c=Math.min(c,d);if(a==b)return c;for(var d=0,e=1;;){var f=a.substring(c-e),f=b.indexOf(f);if(-1==f)return d;e+=f;if(0==f||a.substring(c-e)==b.substring(0,e))d=e,e++}};
diff_match_patch.prototype.diff_halfMatch_=function(a,b){function c(a,b,c){for(var d=a.substring(c,c+Math.floor(a.length/4)),e=-1,g="",h,j,n,l;-1!=(e=b.indexOf(d,e+1));){var m=f.diff_commonPrefix(a.substring(c),b.substring(e)),s=f.diff_commonSuffix(a.substring(0,c),b.substring(0,e));g.length<s+m&&(g=b.substring(e-s,e)+b.substring(e,e+m),h=a.substring(0,c-s),j=a.substring(c+m),n=b.substring(0,e-s),l=b.substring(e+m))}return 2*g.length>=a.length?[h,j,n,l,g]:null}if(0>=this.Diff_Timeout)return null;
var d=a.length>b.length?a:b,e=a.length>b.length?b:a;if(4>d.length||2*e.length<d.length)return null;var f=this,g=c(d,e,Math.ceil(d.length/4)),d=c(d,e,Math.ceil(d.length/2)),h;if(!g&&!d)return null;h=d?g?g[4].length>d[4].length?g:d:d:g;var j;a.length>b.length?(g=h[0],d=h[1],e=h[2],j=h[3]):(e=h[0],j=h[1],g=h[2],d=h[3]);h=h[4];return[g,d,e,j,h]};
diff_match_patch.prototype.diff_cleanupSemantic=function(a){for(var b=!1,c=[],d=0,e=null,f=0,g=0,h=0,j=0,i=0;f<a.length;)0==a[f][0]?(c[d++]=f,g=j,h=i,i=j=0,e=a[f][1]):(1==a[f][0]?j+=a[f][1].length:i+=a[f][1].length,e&&(e.length<=Math.max(g,h)&&e.length<=Math.max(j,i))&&(a.splice(c[d-1],0,[-1,e]),a[c[d-1]+1][0]=1,d--,d--,f=0<d?c[d-1]:-1,i=j=h=g=0,e=null,b=!0)),f++;b&&this.diff_cleanupMerge(a);this.diff_cleanupSemanticLossless(a);for(f=1;f<a.length;){if(-1==a[f-1][0]&&1==a[f][0]){b=a[f-1][1];c=a[f][1];
d=this.diff_commonOverlap_(b,c);e=this.diff_commonOverlap_(c,b);if(d>=e){if(d>=b.length/2||d>=c.length/2)a.splice(f,0,[0,c.substring(0,d)]),a[f-1][1]=b.substring(0,b.length-d),a[f+1][1]=c.substring(d),f++}else if(e>=b.length/2||e>=c.length/2)a.splice(f,0,[0,b.substring(0,e)]),a[f-1][0]=1,a[f-1][1]=c.substring(0,c.length-e),a[f+1][0]=-1,a[f+1][1]=b.substring(e),f++;f++}f++}};
diff_match_patch.prototype.diff_cleanupSemanticLossless=function(a){function b(a,b){if(!a||!b)return 6;var c=a.charAt(a.length-1),d=b.charAt(0),e=c.match(diff_match_patch.nonAlphaNumericRegex_),f=d.match(diff_match_patch.nonAlphaNumericRegex_),g=e&&c.match(diff_match_patch.whitespaceRegex_),h=f&&d.match(diff_match_patch.whitespaceRegex_),c=g&&c.match(diff_match_patch.linebreakRegex_),d=h&&d.match(diff_match_patch.linebreakRegex_),i=c&&a.match(diff_match_patch.blanklineEndRegex_),j=d&&b.match(diff_match_patch.blanklineStartRegex_);
return i||j?5:c||d?4:e&&!g&&h?3:g||h?2:e||f?1:0}for(var c=1;c<a.length-1;){if(0==a[c-1][0]&&0==a[c+1][0]){var d=a[c-1][1],e=a[c][1],f=a[c+1][1],g=this.diff_commonSuffix(d,e);if(g)var h=e.substring(e.length-g),d=d.substring(0,d.length-g),e=h+e.substring(0,e.length-g),f=h+f;for(var g=d,h=e,j=f,i=b(d,e)+b(e,f);e.charAt(0)===f.charAt(0);){var d=d+e.charAt(0),e=e.substring(1)+f.charAt(0),f=f.substring(1),k=b(d,e)+b(e,f);k>=i&&(i=k,g=d,h=e,j=f)}a[c-1][1]!=g&&(g?a[c-1][1]=g:(a.splice(c-1,1),c--),a[c][1]=
h,j?a[c+1][1]=j:(a.splice(c+1,1),c--))}c++}};diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;diff_match_patch.whitespaceRegex_=/\s/;diff_match_patch.linebreakRegex_=/[\\r\\n]/;diff_match_patch.blanklineEndRegex_=/\\n\\r?\\n$/;diff_match_patch.blanklineStartRegex_=/^\\r?\\n\\r?\\n/;
diff_match_patch.prototype.diff_cleanupEfficiency=function(a){for(var b=!1,c=[],d=0,e=null,f=0,g=!1,h=!1,j=!1,i=!1;f<a.length;){if(0==a[f][0])a[f][1].length<this.Diff_EditCost&&(j||i)?(c[d++]=f,g=j,h=i,e=a[f][1]):(d=0,e=null),j=i=!1;else if(-1==a[f][0]?i=!0:j=!0,e&&(g&&h&&j&&i||e.length<this.Diff_EditCost/2&&3==g+h+j+i))a.splice(c[d-1],0,[-1,e]),a[c[d-1]+1][0]=1,d--,e=null,g&&h?(j=i=!0,d=0):(d--,f=0<d?c[d-1]:-1,j=i=!1),b=!0;f++}b&&this.diff_cleanupMerge(a)};
diff_match_patch.prototype.diff_cleanupMerge=function(a){a.push([0,""]);for(var b=0,c=0,d=0,e="",f="",g;b<a.length;)switch(a[b][0]){case 1:d++;f+=a[b][1];b++;break;case -1:c++;e+=a[b][1];b++;break;case 0:1<c+d?(0!==c&&0!==d&&(g=this.diff_commonPrefix(f,e),0!==g&&(0<b-c-d&&0==a[b-c-d-1][0]?a[b-c-d-1][1]+=f.substring(0,g):(a.splice(0,0,[0,f.substring(0,g)]),b++),f=f.substring(g),e=e.substring(g)),g=this.diff_commonSuffix(f,e),0!==g&&(a[b][1]=f.substring(f.length-g)+a[b][1],f=f.substring(0,f.length-
g),e=e.substring(0,e.length-g))),0===c?a.splice(b-d,c+d,[1,f]):0===d?a.splice(b-c,c+d,[-1,e]):a.splice(b-c-d,c+d,[-1,e],[1,f]),b=b-c-d+(c?1:0)+(d?1:0)+1):0!==b&&0==a[b-1][0]?(a[b-1][1]+=a[b][1],a.splice(b,1)):b++,c=d=0,f=e=""}""===a[a.length-1][1]&&a.pop();c=!1;for(b=1;b<a.length-1;)0==a[b-1][0]&&0==a[b+1][0]&&(a[b][1].substring(a[b][1].length-a[b-1][1].length)==a[b-1][1]?(a[b][1]=a[b-1][1]+a[b][1].substring(0,a[b][1].length-a[b-1][1].length),a[b+1][1]=a[b-1][1]+a[b+1][1],a.splice(b-1,1),c=!0):a[b][1].substring(0,
a[b+1][1].length)==a[b+1][1]&&(a[b-1][1]+=a[b+1][1],a[b][1]=a[b][1].substring(a[b+1][1].length)+a[b+1][1],a.splice(b+1,1),c=!0)),b++;c&&this.diff_cleanupMerge(a)};diff_match_patch.prototype.diff_xIndex=function(a,b){var c=0,d=0,e=0,f=0,g;for(g=0;g<a.length;g++){1!==a[g][0]&&(c+=a[g][1].length);-1!==a[g][0]&&(d+=a[g][1].length);if(c>b)break;e=c;f=d}return a.length!=g&&-1===a[g][0]?f:f+(b-e)};
diff_match_patch.prototype.diff_prettyHtml=function(a){for(var b=[],c=/&/g,d=/</g,e=/>/g,f=/\\n/g,g=0;g<a.length;g++){var h=a[g][0],j=a[g][1],j=j.replace(c,"&amp;").replace(d,"&lt;").replace(e,"&gt;").replace(f,"&para;<br>");switch(h){case 1:b[g]='<ins style="background:#e6ffe6;">'+j+"</ins>";break;case -1:b[g]='<del style="background:#ffe6e6;">'+j+"</del>";break;case 0:b[g]="<span>"+j+"</span>"}}return b.join("")};
diff_match_patch.prototype.diff_text1=function(a){for(var b=[],c=0;c<a.length;c++)1!==a[c][0]&&(b[c]=a[c][1]);return b.join("")};diff_match_patch.prototype.diff_text2=function(a){for(var b=[],c=0;c<a.length;c++)-1!==a[c][0]&&(b[c]=a[c][1]);return b.join("")};diff_match_patch.prototype.diff_levenshtein=function(a){for(var b=0,c=0,d=0,e=0;e<a.length;e++){var f=a[e][0],g=a[e][1];switch(f){case 1:c+=g.length;break;case -1:d+=g.length;break;case 0:b+=Math.max(c,d),d=c=0}}return b+=Math.max(c,d)};
diff_match_patch.prototype.diff_toDelta=function(a){for(var b=[],c=0;c<a.length;c++)switch(a[c][0]){case 1:b[c]="+"+encodeURI(a[c][1]);break;case -1:b[c]="-"+a[c][1].length;break;case 0:b[c]="="+a[c][1].length}return b.join("\t").replace(/%20/g," ")};
diff_match_patch.prototype.diff_fromDelta=function(a,b){for(var c=[],d=0,e=0,f=b.split(/\t/g),g=0;g<f.length;g++){var h=f[g].substring(1);switch(f[g].charAt(0)){case "+":try{c[d++]=[1,decodeURI(h)]}catch(j){throw Error("Illegal escape in diff_fromDelta: "+h);}break;case "-":case "=":var i=parseInt(h,10);if(isNaN(i)||0>i)throw Error("Invalid number in diff_fromDelta: "+h);h=a.substring(e,e+=i);"="==f[g].charAt(0)?c[d++]=[0,h]:c[d++]=[-1,h];break;default:if(f[g])throw Error("Invalid diff operation in diff_fromDelta: "+
f[g]);}}if(e!=a.length)throw Error("Delta length ("+e+") does not equal source text length ("+a.length+").");return c};diff_match_patch.prototype.match_main=function(a,b,c){if(null==a||null==b||null==c)throw Error("Null input. (match_main)");c=Math.max(0,Math.min(c,a.length));return a==b?0:a.length?a.substring(c,c+b.length)==b?c:this.match_bitap_(a,b,c):-1};
diff_match_patch.prototype.match_bitap_=function(a,b,c){function d(a,d){var e=a/b.length,g=Math.abs(c-d);return!f.Match_Distance?g?1:e:e+g/f.Match_Distance}if(b.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var e=this.match_alphabet_(b),f=this,g=this.Match_Threshold,h=a.indexOf(b,c);-1!=h&&(g=Math.min(d(0,h),g),h=a.lastIndexOf(b,c+b.length),-1!=h&&(g=Math.min(d(0,h),g)));for(var j=1<<b.length-1,h=-1,i,k,q=b.length+a.length,r,t=0;t<b.length;t++){i=0;for(k=q;i<k;)d(t,c+
k)<=g?i=k:q=k,k=Math.floor((q-i)/2+i);q=k;i=Math.max(1,c-k+1);var p=Math.min(c+k,a.length)+b.length;k=Array(p+2);for(k[p+1]=(1<<t)-1;p>=i;p--){var w=e[a.charAt(p-1)];k[p]=0===t?(k[p+1]<<1|1)&w:(k[p+1]<<1|1)&w|((r[p+1]|r[p])<<1|1)|r[p+1];if(k[p]&j&&(w=d(t,p-1),w<=g))if(g=w,h=p-1,h>c)i=Math.max(1,2*c-h);else break}if(d(t+1,c)>g)break;r=k}return h};
diff_match_patch.prototype.match_alphabet_=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=0;for(c=0;c<a.length;c++)b[a.charAt(c)]|=1<<a.length-c-1;return b};
diff_match_patch.prototype.patch_addContext_=function(a,b){if(0!=b.length){for(var c=b.substring(a.start2,a.start2+a.length1),d=0;b.indexOf(c)!=b.lastIndexOf(c)&&c.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)d+=this.Patch_Margin,c=b.substring(a.start2-d,a.start2+a.length1+d);d+=this.Patch_Margin;(c=b.substring(a.start2-d,a.start2))&&a.diffs.unshift([0,c]);(d=b.substring(a.start2+a.length1,a.start2+a.length1+d))&&a.diffs.push([0,d]);a.start1-=c.length;a.start2-=c.length;a.length1+=
c.length+d.length;a.length2+=c.length+d.length}};
diff_match_patch.prototype.patch_make=function(a,b,c){var d;if("string"==typeof a&&"string"==typeof b&&"undefined"==typeof c)d=a,b=this.diff_main(d,b,!0),2<b.length&&(this.diff_cleanupSemantic(b),this.diff_cleanupEfficiency(b));else if(a&&"object"==typeof a&&"undefined"==typeof b&&"undefined"==typeof c)b=a,d=this.diff_text1(b);else if("string"==typeof a&&b&&"object"==typeof b&&"undefined"==typeof c)d=a;else if("string"==typeof a&&"string"==typeof b&&c&&"object"==typeof c)d=a,b=c;else throw Error("Unknown call format to patch_make.");
if(0===b.length)return[];c=[];a=new diff_match_patch.patch_obj;for(var e=0,f=0,g=0,h=d,j=0;j<b.length;j++){var i=b[j][0],k=b[j][1];!e&&0!==i&&(a.start1=f,a.start2=g);switch(i){case 1:a.diffs[e++]=b[j];a.length2+=k.length;d=d.substring(0,g)+k+d.substring(g);break;case -1:a.length1+=k.length;a.diffs[e++]=b[j];d=d.substring(0,g)+d.substring(g+k.length);break;case 0:k.length<=2*this.Patch_Margin&&e&&b.length!=j+1?(a.diffs[e++]=b[j],a.length1+=k.length,a.length2+=k.length):k.length>=2*this.Patch_Margin&&
e&&(this.patch_addContext_(a,h),c.push(a),a=new diff_match_patch.patch_obj,e=0,h=d,f=g)}1!==i&&(f+=k.length);-1!==i&&(g+=k.length)}e&&(this.patch_addContext_(a,h),c.push(a));return c};diff_match_patch.prototype.patch_deepCopy=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=new diff_match_patch.patch_obj;e.diffs=[];for(var f=0;f<d.diffs.length;f++)e.diffs[f]=d.diffs[f].slice();e.start1=d.start1;e.start2=d.start2;e.length1=d.length1;e.length2=d.length2;b[c]=e}return b};
diff_match_patch.prototype.patch_apply=function(a,b){if(0==a.length)return[b,[]];a=this.patch_deepCopy(a);var c=this.patch_addPadding(a);b=c+b+c;this.patch_splitMax(a);for(var d=0,e=[],f=0;f<a.length;f++){var g=a[f].start2+d,h=this.diff_text1(a[f].diffs),j,i=-1;if(h.length>this.Match_MaxBits){if(j=this.match_main(b,h.substring(0,this.Match_MaxBits),g),-1!=j&&(i=this.match_main(b,h.substring(h.length-this.Match_MaxBits),g+h.length-this.Match_MaxBits),-1==i||j>=i))j=-1}else j=this.match_main(b,h,g);
if(-1==j)e[f]=!1,d-=a[f].length2-a[f].length1;else if(e[f]=!0,d=j-g,g=-1==i?b.substring(j,j+h.length):b.substring(j,i+this.Match_MaxBits),h==g)b=b.substring(0,j)+this.diff_text2(a[f].diffs)+b.substring(j+h.length);else if(g=this.diff_main(h,g,!1),h.length>this.Match_MaxBits&&this.diff_levenshtein(g)/h.length>this.Patch_DeleteThreshold)e[f]=!1;else{this.diff_cleanupSemanticLossless(g);for(var h=0,k,i=0;i<a[f].diffs.length;i++){var q=a[f].diffs[i];0!==q[0]&&(k=this.diff_xIndex(g,h));1===q[0]?b=b.substring(0,
j+k)+q[1]+b.substring(j+k):-1===q[0]&&(b=b.substring(0,j+k)+b.substring(j+this.diff_xIndex(g,h+q[1].length)));-1!==q[0]&&(h+=q[1].length)}}}b=b.substring(c.length,b.length-c.length);return[b,e]};
diff_match_patch.prototype.patch_addPadding=function(a){for(var b=this.Patch_Margin,c="",d=1;d<=b;d++)c+=String.fromCharCode(d);for(d=0;d<a.length;d++)a[d].start1+=b,a[d].start2+=b;var d=a[0],e=d.diffs;if(0==e.length||0!=e[0][0])e.unshift([0,c]),d.start1-=b,d.start2-=b,d.length1+=b,d.length2+=b;else if(b>e[0][1].length){var f=b-e[0][1].length;e[0][1]=c.substring(e[0][1].length)+e[0][1];d.start1-=f;d.start2-=f;d.length1+=f;d.length2+=f}d=a[a.length-1];e=d.diffs;0==e.length||0!=e[e.length-1][0]?(e.push([0,
c]),d.length1+=b,d.length2+=b):b>e[e.length-1][1].length&&(f=b-e[e.length-1][1].length,e[e.length-1][1]+=c.substring(0,f),d.length1+=f,d.length2+=f);return c};
diff_match_patch.prototype.patch_splitMax=function(a){for(var b=this.Match_MaxBits,c=0;c<a.length;c++)if(!(a[c].length1<=b)){var d=a[c];a.splice(c--,1);for(var e=d.start1,f=d.start2,g="";0!==d.diffs.length;){var h=new diff_match_patch.patch_obj,j=!0;h.start1=e-g.length;h.start2=f-g.length;""!==g&&(h.length1=h.length2=g.length,h.diffs.push([0,g]));for(;0!==d.diffs.length&&h.length1<b-this.Patch_Margin;){var g=d.diffs[0][0],i=d.diffs[0][1];1===g?(h.length2+=i.length,f+=i.length,h.diffs.push(d.diffs.shift()),
j=!1):-1===g&&1==h.diffs.length&&0==h.diffs[0][0]&&i.length>2*b?(h.length1+=i.length,e+=i.length,j=!1,h.diffs.push([g,i]),d.diffs.shift()):(i=i.substring(0,b-h.length1-this.Patch_Margin),h.length1+=i.length,e+=i.length,0===g?(h.length2+=i.length,f+=i.length):j=!1,h.diffs.push([g,i]),i==d.diffs[0][1]?d.diffs.shift():d.diffs[0][1]=d.diffs[0][1].substring(i.length))}g=this.diff_text2(h.diffs);g=g.substring(g.length-this.Patch_Margin);i=this.diff_text1(d.diffs).substring(0,this.Patch_Margin);""!==i&&
(h.length1+=i.length,h.length2+=i.length,0!==h.diffs.length&&0===h.diffs[h.diffs.length-1][0]?h.diffs[h.diffs.length-1][1]+=i:h.diffs.push([0,i]));j||a.splice(++c,0,h)}}};diff_match_patch.prototype.patch_toText=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];return b.join("")};
diff_match_patch.prototype.patch_fromText=function(a){var b=[];if(!a)return b;a=a.split("\\n");for(var c=0,d=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;c<a.length;){var e=a[c].match(d);if(!e)throw Error("Invalid patch string: "+a[c]);var f=new diff_match_patch.patch_obj;b.push(f);f.start1=parseInt(e[1],10);""===e[2]?(f.start1--,f.length1=1):"0"==e[2]?f.length1=0:(f.start1--,f.length1=parseInt(e[2],10));f.start2=parseInt(e[3],10);""===e[4]?(f.start2--,f.length2=1):"0"==e[4]?f.length2=0:(f.start2--,f.length2=
parseInt(e[4],10));for(c++;c<a.length;){e=a[c].charAt(0);try{var g=decodeURI(a[c].substring(1))}catch(h){throw Error("Illegal escape in patch_fromText: "+g);}if("-"==e)f.diffs.push([-1,g]);else if("+"==e)f.diffs.push([1,g]);else if(" "==e)f.diffs.push([0,g]);else if("@"==e)break;else if(""!==e)throw Error('Invalid patch mode "'+e+'" in: '+g);c++}}return b};diff_match_patch.patch_obj=function(){this.diffs=[];this.start2=this.start1=null;this.length2=this.length1=0};
diff_match_patch.patch_obj.prototype.toString=function(){var a,b;a=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1;b=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;a=["@@ -"+a+" +"+b+" @@\\n"];var c;for(b=0;b<this.diffs.length;b++){switch(this.diffs[b][0]){case 1:c="+";break;case -1:c="-";break;case 0:c=" "}a[b+1]=c+encodeURI(this.diffs[b][1])+"\\n"}return a.join("").replace(/%20/g," ")};
this.diff_match_patch=diff_match_patch;this.DIFF_DELETE=-1;this.DIFF_INSERT=1;this.DIFF_EQUAL=0;})()</script>
<script type="text/javascript">
/**
 * Illume - Twine Proofing Story Format
 * 
 * Copyright (c) 2015 Michael McCollum
 * http://www.maximumverbosity.net/twine/Illume/
 *
 * This license applies exclusively to the Illume story format for Twine 2. No ownership of, nor
 * licensing restrictions on, the content within the generated story are stated or implied.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and
 * associated documentation files (the "Software"), to deal in the Software without restriction,
 * including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial
 * portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
 * LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
window.onload = function() {
if (typeof(window.Illume) == "undefined") {


window.Illume = {

init: function() { 
Illume.UI.init();
Illume.Editor.init();
Illume.Diff.init();
Illume.Story.init();
Illume.Passages.init();
Illume.Overview.init();

this.UI.updateList();
this.Overview.showStoryOverview();

},


popout:function(content) {
var w = window.open();
w.document.write(content);
},

download:function(filename, text, contentType) {
if (!contentType)
contentType = 'text/plain';

window.URL = window.URL || window.webkitURL;
var dataBlob = new Blob([text], {type: contentType});

var downloader = document.createElement('a');
downloader.setAttribute('innerHtml', 'downloader');
downloader.setAttribute('href', window.URL.createObjectURL(dataBlob));
downloader.setAttribute('download', filename);
downloader.onclick = function() {
document.body.removeChild(event.target);
};
document.body.appendChild(downloader);
downloader.click();
},

viewChangeList:function() {
this.generateChangeList(false);
},

saveChangeList:function() {
this.generateChangeList(true);
},

generateChangeList:function(forExport) {
var buffer = [];
var diffs;
var p;

var matches = Illume.Passages.findPassages(function(p) { return p.changed;});
var title = Illume.Story.storyName + ' Change List - ' + (new Date()).toLocaleString();

if (matches.length < 1) {
alert('No changes have been made.');
return '';
}

buffer.push('<html><he','ad>');
buffer.push('<title>',title,'</title>');
buffer.push('<style type="text/css">');
buffer.push('ins {background: #9f9;} del {background: #f99;}');
buffer.push("body{font-family:'Open Sans','Source Code Pro','Deja Vu Sans','Arial',sans-serif;}");
buffer.push("h1{text-align:center;}");
buffer.push("h2{margin:50px 0px 0px 10px;}");
buffer.push("input{float:right;}");
buffer.push("pre{margin: 0px;line-height: 175%;font-size: 12pt;border: solid #999;border-width: 1px 0px 1px 0px;}");
buffer.push('</style>');
buffer.push('</he','ad><bo','dy>');

buffer.push('<h1>', title, '</h1>');

for (var i in matches) {
p = matches[i];
diffs = window.Illume.Diff.diff(this.encodeEntities(p.originalContent), this.encodeEntities(p.content));

buffer.push('<div id="p.' + p.id + '">');
buffer.push('<input type="button" value="Done" onclick="this.parentNode.remove(this);" />');
buffer.push("<h2>", p.name, "</h2>");
buffer.push("<pre>", window.Illume.Diff.formatDiffs(diffs),"</pre>");
buffer.push("</div>");
}

buffer.push('</bo', 'dy></html>');

var output = buffer.join('');

if (forExport) {
this.download(title + '.html', output, 'text/html');
} else {
this.popout(output);
}

},

encodeEntities:function(s) {
return String(s).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
},

exportTwee: function() {
this.download(Illume.Story.storyName + ".tw", Illume.Entweedle.export(), 'text/plain');
},

saveToFile:function() {
alert("Note: the saved file will be a fresh copy of this illumination and will not include any changes you've made to this version.");
this.download(Illume.Story.storyName + " (Illuminated).html", window.document.documentElement.innerHTML, 'text/html');
}


}


window.Illume.Overview = {
introText: '',
tips: '',

init:function() {
this.introText = window.document.getElementById('introText').innerHTML;
this.tips = window.document.getElementById('tips').innerHTML;
},

showStoryOverview:function() {
Illume.Story.compileStats();

var buffer = [];

buffer.push(this.generateTile("Welcome to Illume", Illume.Overview.introText,'2x1'));
buffer.push(this.generateTile("Stats", this.generateTable(Illume.Story.generateStorySummary()) + '<p>These do not reflect changes made during review or by macros during play.</p>'));
buffer.push(this.generateTile("Review Summary", this.generateTable(Illume.Passages.generateReviewSummary())));

buffer.push(this.generateTile("Passage Summary", this.generateTable(Illume.Passages.generateSummary()),'2x1'));
buffer.push(this.generateTile("Tags", this.generateTable(Illume.Story.getTagSummary(), true),'1x1'));

buffer.push(this.generateTile("Tips", Illume.Overview.tips));


Illume.UI.showGeneralOutput('Story Overview', buffer.join(''));
},

generateTile:function(title,content,size,classes) {
var buffer = [];
if (!size)
size = '1x1';

buffer.push('<div class="infoTile tile', size, ' ', classes, '"><div class="title">');
buffer.push(title);
buffer.push('</div><div class="content">');
buffer.push(content);
buffer.push('</div></div>');

return buffer.join('');
},

generateTable:function(o, preserveLabels) {
var label,link,data;
var buffer = [];
var isHeader = false;

buffer.push("<table>");
for (key in o) {
label = key;

if (label.indexOf("header.") > -1) {
label = label.substring(7);
isHeader = true;
} else {
isHeader = false
}


if (!preserveLabels) {
label = label.replace(/[A-Z][a-z]*/g, function(word) { return ' ' + word.charAt(0).toUpperCase() + word.substr(1);});
label = label.charAt(0).toUpperCase() + label.substr(1);
}

data = o[key];

link = data['illumeLink'];

buffer.push("<tr");
if (isHeader) {
buffer.push(' class="header"');
}
buffer.push("><td>");
if (link && link.length > 0) {
buffer.push('<span class="link" onclick="' + link + '">');
}
buffer.push(label);
if (link) {
buffer.push('</span>');
}
buffer.push("</td>");
if (typeof data == "object") {
for (var i in data) {
if (i == 'illumeLink')
continue;

buffer.push('<td>', data[i], '</td>');
}
} else {
buffer.push('<td>', data, '</td>')
}
buffer.push("</tr>");
}
buffer.push("</table>");

return buffer.join('');

}
}


window.Illume.Diff = {
logic: null,

init:function() {
this.logic = new window.diff_match_patch();
},

diff: function(s1, s2) {
var diffs = this.logic.diff_main(s1, s2);
this.cleanup(diffs);
return diffs;
},

cleanup:function(diffs) {
this.logic.diff_cleanupSemantic(diffs);
},

formatDiffs:function(diffs) {
var html = [];
var i = 0;
for (var x = 0; x < diffs.length; x++) {
var op = diffs[x][0];    
var data = diffs[x][1];
var text = data;
switch (op) {
case window.DIFF_INSERT:
html[x] = '<ins>' + text + '</ins>';
break;
case window.DIFF_DELETE:
html[x] = '<del>' + text + '</del>';
break;
case window.DIFF_EQUAL:
html[x] = '' + text + '';
break;
}
if (op !== window.DIFF_DELETE) {
i += data.length;
}
}
return html.join('');
}

}


window.Illume.UI = {
filter:null,
filterTag: null,
byTagOption: null,
passageListContent: null,
passageViewer: null,
generalOutput: null,

init:function() {
this.filter = window.document.getElementById('filter');
this.byTagOption = window.document.getElementById('byTagOption');
this.passageListContent = window.document.getElementById('passageListContent');
this.passageViewer = window.document.getElementById('passageViewer');
this.generalOutput = window.document.getElementById('generalOutput');
},

filterChanged: function() {
if (this.filter.value == 'byTag') {
this.filterTag = null;
}
this.updateList();
},

filterByTag:function(tag) {
this.filterTag = tag;
this.filter.value = 'byTag';
this.updateList();
},

updateFilterList:function() {
this.byTagOption.textContent = "By Tag...";
},

switchFilter:function(value) {
this.filter.value = value;
this.updateList();
},


updateList:function() {
var matches = {};

if (this.filter.value == 'unreviewed') {
matches = Illume.Passages.findPassages(function(p) { return !p.reviewed;});
} else if (this.filter.value == 'reviewed') {
matches = Illume.Passages.findPassages(function(p) { return p.reviewed;});
} else if (this.filter.value == 'changed') {
matches = Illume.Passages.findPassages(function(p) { return p.changed;});
} else if (this.filter.value == 'unchanged') {
matches = Illume.Passages.findPassages(function(p) { return !p.changed;});
} else if (this.filter.value == 'orphans') {
matches = Illume.Passages.findPassages(function(p) { return (p.inboundLinks == 0)});
} else if (this.filter.value == 'deadEnds') {
matches = Illume.Passages.findPassages(function(p) { return (p.links == 0)});
} else if (this.filter.value == 'passThroughs') {
matches = Illume.Passages.findPassages(function(p) { return (p.links == 1 && p.inboundLinks == 1)});
} else if (this.filter.value == 'all') {
matches = Illume.Passages.getAll();
} else if (this.filter.value == 'byTag') {
if (!this.filterTag)
this.filterTag = window.prompt("Show passages with tag:");
if (!this.filterTag)
return;

this.byTagOption.textContent = "By Tag... [" + this.filterTag + "]";

matches = Illume.Passages.findByTag(this.filterTag);
}

this.passageListContent.innerHTML = '';

var buffer = [];

for (var i in matches) {
buffer.push("<span onclick=\"window.Illume.UI.showPassage('", matches[i].id, "');\">");
if (matches[i].reviewed) {
buffer.push('<div class="flag reviewed">R</div>');
}
if (matches[i].changed) {
buffer.push('<div class="flag changed">C</div>');
}
buffer.push(matches[i].name);
buffer.push("</span>");
}

this.passageListContent.innerHTML = buffer.join('');

this.updateFooter();
},

updateFooter:function() {
var footerLeft = window.document.getElementById('footerLeft');
var footerRight = window.document.getElementById('footerRight');

var reviewed = Illume.Passages.countPassages(function(p) { return p.reviewed;});
var changed = Illume.Passages.countPassages(function(p) { return p.changed;});
var total = Illume.Passages.passageCount;
var remaining = total - reviewed;
var reviewedPercentage = Math.ceil((reviewed / total) * 100);

var buffer = [];

if (remaining > 0) {
buffer.push(reviewed, ' reviewed, ');
buffer.push(remaining, ' remaining');
buffer.push(" (");
}
buffer.push(reviewedPercentage, '% reviewed');
if (remaining > 0) {
buffer.push(')');
}

footerLeft.innerHTML = buffer.join('');

buffer = [];

if (changed > 0) {
buffer.push(changed);
buffer.push(' changed <input type="button" id="footerChangeListButton" value="Show Change List" onclick="Illume.viewChangeList()">');
}

footerRight.innerHTML = buffer.join('');



},

showGeneralOutput:function(title, content) {
var header = window.document.getElementById('generalTitle');
var body = window.document.getElementById('generalContent');

header.innerHTML = title;
body.innerHTML = content;

generalOutput.style.display = 'block';
passageViewer.style.display = 'none';
},

showPassage:function(id) {
var p = Illume.Passages.getPassage(id);

if (!p) {
alert(id + ' not found');
return;
}

window.document.getElementById("passageTitle").textContent = p.name;

var tagContainer = window.document.getElementById("passageTags");

tagContainer.innerHTML = '';

var buffer = [];
for (var i in p.tags) {
if (p.tags[i]) {
buffer.push("<span class=\"tag\" onclick=\"window.Illume.UI.filterByTag('");
buffer.push(p.tags[i]);
buffer.push("');\">");
buffer.push(p.tags[i]);
buffer.push("</span>");
}
}

tagContainer.innerHTML = buffer.join('');

Illume.Editor.editPassage(id);

generalOutput.style.display = 'none';
passageViewer.style.display = 'block';

}


}


window.Illume.Editor = {
editor:null,
currentPassageID: null,
currentPassage: null,
changeViewer: null,
controls: null,
changesShown: false,

init:function() {
this.editor = window.document.getElementById('editor');
this.controls = window.document.getElementById('passageControls');
this.changeViewer = window.document.getElementById('changeViewer');

this.editor.onchange = this.changeHandler;
this.editor.onkeyup = this.inputHandler;
},

editPassage:function(id) {
this.currentPassageID = id;
this.currentPassage = Illume.Passages.getPassage(id);

this.editor.value = this.currentPassage.content;
this.updateControls();
},

setReviewedHandler:function(isReviewed) {
Illume.Editor.setReviewed(isReviewed);
},

setReviewed:function(isReviewed) {
if (this.currentPassage.reviewed != isReviewed) {
this.currentPassage.reviewed = isReviewed;
this.updateControls();
Illume.UI.updateList();
}
},

revert:function() {
this.currentPassage.content = this.currentPassage.originalContent;
this.currentPassage.changed = false;
this.editPassage(this.currentPassageID);
Illume.UI.updateList();
this.hideChanges();
},

updateControls:function() {
var c = window.document.getElementById('dirtyControls');
var r = window.document.getElementById('reviewedControls');
var ur = window.document.getElementById('unreviewedControls');

c.style.display = (this.currentPassage.changed) ? 'inline-block' : 'none';
r.style.display = (this.currentPassage.reviewed) ? 'inline-block' : 'none';
ur.style.display = (!this.currentPassage.reviewed) ? 'inline-block' : 'none';

this.currentPassage.changed ? this.showChanges() : this.hideChanges();
},

showChanges: function() {
this.updateChangeViewer(true);
this.updateChangeDiffs();
},

hideChanges:function() {
this.updateChangeViewer(false);
},

toggleChanges:function() {
this.updateChangeViewer(!this.changesShown);
},

updateChangeViewer:function(shown) {
this.changeViewer.style.display = (shown ? 'block' : 'none');
//this.editor.style.bottom = (shown ? '300px' : '0px');   //DEBUG
window.document.getElementById('editorCorral').style.bottom = (shown ? '300px' : '0px');

this.changesShown = shown;
this.updateChangeDiffs();
},

updateChangeDiffs:function() {
if (this.changesShown) {
var p = this.currentPassage;
var diffs = window.Illume.Diff.diff(Illume.encodeEntities(p.originalContent), Illume.encodeEntities(p.content));
this.changeViewer.innerHTML = window.Illume.Diff.formatDiffs(diffs);
}
},

updatePassage:function() {
this.currentPassage.content = this.editor.value;
},

inputHandler:function() {
if (!Illume.Editor.currentPassage.changed) {
Illume.Editor.currentPassage.changed = true;
Illume.UI.updateList();
}
Illume.Editor.updatePassage();
Illume.Editor.updateControls();
Illume.Editor.updateChangeDiffs();
},

changeHandler:function() {
Illume.Editor.updatePassage();
Illume.Editor.updateControls();
Illume.Editor.updateChangeDiffs();
}


}


window.Illume.Story = {
storyData:null,
storyName:'A Warm Place to Stay',
storyFormat: '',
startPassage: 1,
stats: {},
wordCount: 0,
tags: {},

init:function() {
this.loadStoryData();
},

loadStoryData:function() {
var storyDataElements = window.document.getElementsByTagName("tw-storydata");
if (storyDataElements.length > 0) {
this.storyData = storyDataElements[0];
this.storyFormat = this.storyData.getAttribute("format");
this.startPassage = this.storyData.getAttribute("startnode");
}
},

compileStats:function() {
var p;

var s = {
format: this.storyFormat,
passageCount: Illume.Passages.passageCount,
wordCount: this.wordCount,
orphans: Illume.Passages.countPassages( function(p) { return (p.inboundLinks < 1); }),
deadEnds: Illume.Passages.countPassages( function(p) { return (p.links < 1); }),
'pass-throughs': Illume.Passages.countPassages( function(p) { return (p.links == 1 && p.inboundLinks == 1); }),

averageLinks: Math.floor(Illume.Passages.averageConnectivity * 100) / 100 ,
averageWords: Math.floor(Illume.Passages.averageLength * 100) / 100

};

this.stats = s;
},

generateStorySummary:function() {
var result = Object.create(this.stats);

result['format'] = result.format;
result.orphans = {
illumeLink:"Illume.UI.switchFilter('orphans');",
value:result.deadEnds
}
result.deadEnds = {
illumeLink:"Illume.UI.switchFilter('deadEnds');",
value:result.deadEnds
}
result['pass-throughs'] = {
illumeLink:"Illume.UI.switchFilter('passThroughs');",
value:result['pass-throughs']
}
result.passageCount = {
illumeLink:"Illume.UI.switchFilter('all');",
value:result.passageCount
}

return result;
},

getTagSummary:function() {
var results = {
"header.Tag": "Occurences"
}
var label;

for (var t in this.tags) {
label = "<span class=\"tag\" onclick=\"window.Illume.UI.filterByTag('" + t + "');\">" + t + "</span>";
results[label] = this.tags[t];
}

return results;
}

}


window.Illume.Passages = {
passages: [],
linkCount:{},
deadLinks:[],
passageCount: 0,
averageConnectivity: 0,
averageLength: 0,

basePassage: {
id:-1,
name: "Undefined",
tags: [],
links: 0,
inboundLinks: 0,
connections: 0,
sugarcubeMacros: 0,
harloweMacros: 0,
harloweHooks: 0,
wordCount: 0,
content: '',
originalContent: '',
reviewed: false,
changed: false
},


init: function() {
this.loadPassages();
},

getPassage: function(id) {
return this.passages[id];
},

getAll:function() {
return this.passages.slice();
},

findByTag:function(tag) {
var results = [];
var p;

results.length = 0;
for (var i = 0; i < this.passages.length; i++) {
p = this.passages[i];
if (p && p.tags.indexOf(tag) > -1) {
results.push(p);
}
}
return results;
},

findByName:function(name) {
var p;

for (var i in this.passages) {
p = this.passages[i];
if (p && p.name == name) {
return p;
}
}
return null;
},

findPassages:function(checkFunction) {
var p;
var results = [];

if (!checkFunction || typeof(checkFunction) != "function") {
return -1;
}

for (var i in this.passages) {
p = this.passages[i];

if (checkFunction(p)) {
results.push(p);
}
}

return results;
},

countPassages:function(checkFunction) {
var results = this.findPassages(checkFunction);
if (!results)
return 0;
else
return results.length;
},

loadPassages: function() {
var passageElements = window.document.getElementsByTagName("tw-passagedata");
var e;
var p;
var tagString;

linkCount = {};

var matchers = {
links:/[^`]\[{2}(.*)\]{2}(?=[^`])/g,
sugarcubeMacros:/\<{2}.*\>{2}/g,
harloweMacros:/[^`]\([^\W]*:.*\)(?=[^`])/g,
harloweHooks:/[^`\[]\[[^\[\]]*\](?=[^`\]])/g
};

this.passages.length = 0;
for (var i = 0; i < passageElements.length; i++) {
p = Object.create(this.basePassage);
e = passageElements[i];

tagString = e.getAttribute("tags").trim();

if (!tagString || tagString.length < 1)
p.tags = [];
else 
p.tags = tagString.split(" ");

if (p.tags.indexOf("illumeIgnore") > -1) {
continue;
}

if (p.tags.indexOf("illumeReviewed") > -1) {
p.reviewed = true;
}

p.id = e.getAttribute("pid");
p.name = e.getAttribute("name");
p.content = e.textContent;
p.originalContent = e.textContent;
p.strippedContent = e.textContent;

for (var j in matchers) {
p[j] = (p.content.match(matchers[j]) || []).length;
}

if (p.harloweMacros > 0)
p.strippedContent = p.strippedContent.replace(matchers.harloweMacros, '');


if (p.sugarcubeMacros > 0)
p.strippedContent = p.strippedContent.replace(matchers.sugarcubeMacros, '');

var re, match, destination;

re = matchers.links;
re.lastIndex = 0;

var destinations = [];


while ((match = re.exec(' ' + p.content + ' ')) !== null) {
destination = match[1];

if (destination.indexOf("->") > -1) {
//harlowe right link
destination = destination.substring(destination.indexOf("->") + 2);
} else if (destination.indexOf("<-") > -1) {
//harlowe left link
destination = destination.substring(0, destination.indexOf("<-"));
} else if (destination.indexOf("|") > -1) {
//sugarcube link
destination = destination.substring(destination.indexOf("|") + 1);
}

if (destinations.indexOf(destination) < 0)
destinations.push(destination);
}


for (var d in destinations) {
//alert('adding a link from ' + p.name + ' to ' + destinations[d]);
if (linkCount[destinations[d]])
++linkCount[destinations[d]];
else
linkCount[destinations[d]] = 1;
}

p.wordCount = p.strippedContent.trim().replace(/\s+/g, ' ').split(' ').length;

this.passages[p.id] = p;
}


var killList = [];
var connectivityTotal = 0;
this.passageCount = 0
Illume.Story.wordCount = 0;
Illume.Story.tags = {};

for (var i in this.passages) {
p = this.passages[i];
p.inboundLinks = (linkCount[p.name] || 0);
p.connections = p.links + p.inboundLinks;
killList.push(p.name);

Illume.Story.wordCount += p.wordCount;
connectivityTotal += p.connections;
++this.passageCount;

for (var t in p.tags) {
if (!Illume.Story.tags[p.tags[t]])
Illume.Story.tags[p.tags[t]] = 1;
else
++Illume.Story.tags[p.tags[t]];
}
}

for (var n in killList) {
delete(linkCount[killList[n]]);
}

this.averageLength = Illume.Story.wordCount / this.passageCount;
this.averageConnectivity = connectivityTotal / this.passageCount;

this.deadLinks = linkCount;
},

generateSummary:function() {
var ps = this.passages.slice();
var results = {};
var p;

ps.sort(function(a,b) {
if (a.connections < b.connections)
return 1;
if (a.connections > b.connections)
return -1;
return 0;
});

results["header.Passage"] = [
'Length',
'Links (In/Out)'
];

for (var i in ps) {
p = ps[i];
results[p.name] = {
illumeLink:"Illume.UI.showPassage('" + p.id + "');",
wordCount: p.wordCount,
connections: p.connections + " (" + p.inboundLinks + "/" + p.links + ")"
};
}

return results;
},

generateReviewSummary:function() {
var result = {};
var reviewed = this.countPassages(function(p) { return p.reviewed;});
var changed = this.countPassages(function(p) { return p.changed;});

result['totalPassages'] = {
illumeLink:"window.Illume.UI.switchFilter('all');",
value: this.passageCount
}
result['changed'] = {
illumeLink:"window.Illume.UI.switchFilter('changed');",
value: changed
};
result['reviewed'] = {
illumeLink:"window.Illume.UI.switchFilter('reviewed');",
value:reviewed
};
result['reviewCompleted'] = {
illumeLink:"window.Illume.UI.switchFilter('unreviewed');",
value:Math.ceil(reviewed / this.passageCount * 100) + '%'
};



return result;
}

}


window.Illume.Entweedle = {

export: function() {
var output = window.document.getElementById("output");
var buffer = [];

var storyData = window.document.getElementsByTagName("tw-storydata");
if (storyData) {
buffer.push(this.buildPassage("StoryTitle","",storyData[0].getAttribute("name")));
}
var userScript = window.document.getElementById("twine-user-script");
if (userScript) {
buffer.push(this.buildPassage("UserScript","script",userScript.innerHTML));
}

var userStylesheet = window.document.getElementById("twine-user-stylesheet");
if (userStylesheet) {
buffer.push(this.buildPassage("UserStylesheet","stylesheet",userStylesheet.innerHTML));
}

var passages = window.document.getElementsByTagName("tw-passagedata");
for (var i = 0; i < passages.length; i++) {
buffer.push(this.buildPassageFromElement(passages[i]));
}

return buffer.join('');
},


buildPassageFromElement: function(passage) {
var name = passage.getAttribute("name");
if (!name) {
name = "Untitled Passage";
}
var tags = passage.getAttribute("tags");
var content = passage.textContent;

return this.buildPassage(name, tags, content);
},

buildPassage: function(title, tags, content) {
var result = [];

result.push(":: ",title);
if (tags) {
result.push("[",tags,"]");
}
result.push("\r\n", this.scrub(content),"\r\n\r\n");

return result.join('');
},

scrub: function(content) {
content = content.replace(/^::/gm, " ::");
return content;
}
}


window.Illume.init();
}
}

</script>
</head>
<body>
<div id="header">
A Warm Place to Stay
</div>
<div id="workspace">
<div id="sidebar">
<div id="links">
<span onclick="window.Illume.Overview.showStoryOverview();">Story Overview</span>
<span onclick="window.Illume.viewChangeList();">View Change List</span>
<span onclick="window.Illume.saveChangeList();">Export Change List...</span>
<span onclick="window.Illume.exportTwee();">Export Twee Source</span>
<span onclick="window.Illume.saveToFile();">Export Illumination...</span>
</div>
<div id="passageListHeader">
<select id="filter" oninput="window.Illume.UI.updateFilterList();" onchange="window.Illume.UI.filterChanged();">
<option value="unreviewed">Unreviewed</option>
<option value="reviewed">Reviewed</option>
<option value="changed">Changed</option>
<option value="unchanged">Unchanged</option>
<option value="orphans">Orphans</option>
<option value="deadEnds">Dead Ends</option>
<option value="passThroughs">Pass-Throughs</option>
<option id="byTagOption" value="byTag">By Tag...</option>
<option value="all">All Passages</option>
</select>
</div>
<div id="passageListContent"></div>
</div>
<div id="contentArea">
<div id="generalOutput">
<div id="generalHeader">
<div id="generalTitle"></div>
</div>
<div id="generalContent"></div>
</div>
<div id="passageViewer">
<div id="passageHeader">
<div id="passageTitle"></div>
<div id="passageTags"></div>
</div>
<div id="passageControls">
<div id="dirtyControls">
Modified <input id="revertChangesButton" type="button" value="Revert" onclick="Illume.Editor.revert();" />
</div>
<div id="reviewedControls">
Reviewed <input id="unreviewedButton" type="button" value="Flag as Unreviewed" onclick="Illume.Editor.setReviewedHandler(false);"/>
</div>
<div id="unreviewedControls">
Unreviewed <input id="reviewedButton" type="button" value="Flag as Reviewed" onclick="Illume.Editor.setReviewedHandler(true);"/>
</div>
</div>
<div id="passageContent">
<div id="editorCorral"><textarea id="editor"></textarea></div>
<div id="changeViewer"></div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footerRight"></div>
<div id="footerLeft"></div>
</div>
<div id="introText" style="display: none;">
<p>
This is the Story Overview, from which you can find general information and statistics about your story.
</p>
<p>
Use the list at the lower-left to filter and view the passages of your story, and click on a passage to open it in review mode. While reviewing a passage, you can make changes in-place, compare your changed version to the original, revert those changes if needed, and flag a passage as reviewed to help you keep track of which passages have been reviewed and which ones remain.
</p>
<p>
You can use the links at the top left to view a change list, which shows all changes made to all passages, or export it to a file. You can also save a copy of this illumination for later use, or export your story in twee source format.
</p>
<p>
For more information about Illume, visit the <a href="https://maximumverbosity.net/twine/Illume/">Illume web site</a>.
</p>
</div>
<div id="tips" style="display: none;">
<p>
Tag a passage "illumeIgnore" and it will be totally ignored by Illume for all purposes.
</p>
<p>
If a passage is not being modified, tag it "illumeReviewed" to set its initial state to Reviewed. The editor can still refer back to it if needed.
</p>
</div>
<div id="storyData" style="display: none;">
<!-- UUID://CFB4E6AB-1631-4384-B7DD-D3868FB9835A// --><tw-storydata name="A Warm Place to Stay" startnode="1" creator="Tweego" creator-version="2.1.1+81d1d71" ifid="CFB4E6AB-1631-4384-B7DD-D3868FB9835A" zoom="0.25" format="Illume" format-version="1.0.5" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">:root {
  --light: rgba(0, 0, 0, 20%);
  --accent: #d93;
  --color: #111;
  --background: #eee;
}

body {
  font: 1.2rem/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: var(--color, #111);
  background: var(--background, #eee);
  transition: opacity 1s, background-color 2s;
}

h1,
h2,
h3,
h4,
h5,
h6,
p {
  margin-top: 0;
  margin-bottom: 1rem;
}

h1,
h2 {
  text-align: center;
}

tw-story {
  line-height: inherit;
  position: relative;
  margin: 0 auto;
  padding-bottom: 4rem;
  max-width: 35em;
}

tw-passage {}

a {
  color: var(--color, #111);
  text-decoration-color: var(--light, rgba(0, 0, 0, 20%));
}

a:hover,
a:focus,
a:active {
  color: var(--accent, #d93);
  text-decoration-color: var(--accent, #d93);
}

.list-unstyled {
  list-style: none;
  margin: 0;
  padding-left: 0;
}

.fadeout {
  width: 100%;
  height: 100%;
  pointer-events: none;
  position: absolute;
  bottom: 0%;
  background-image: linear-gradient(to bottom, transparent, var(--background, #eee));
  margin-bottom: 0;
}

.textchat {
  padding: 1rem;
  font-size: smaller;
  font-family: monospace;
  background: rgba(0, 0, 0, 0.05);
  border: 1px solid var(--light);
  border-radius: 0.25rem;
  margin-bottom: 1rem;
}

/* Story Styles (using passage tags) */
body[data-tags~="vore"] {
  --background: #fcc;
}

body[data-tags~="cold"] {
  --background: #eef;
}

body[data-tags~="warm"] {
  --background: #fee;
}

body[data-tags~="dark"] {
  --background: #020202;
  --light: rgba(255, 255, 255, 50%);
  --color: #ccc;
}

[data-tags~="no_heading"] #recent-command {
  display: none;
}

@media screen and (max-width:500px) {
  .passage {
    --logo-height: 3em;
  }

  .logo_main {
    text-align: center;
    align-items: center
  }

  a {
    line-height: 2;
    padding: 2rem 0;
  }
}

pre code {
  border-radius: 0.25rem;
  display: block;
  font-size: smaller;
  background: rgba(0, 0, 0, 0.02);
  padding: 0.5rem;
  white-space: pre-wrap;
}

.important {
  padding: 2rem;
  background: rgba(0, 0, 0, 0.01);
  border: 1px solid rgba(0, 0, 0, 0.25);
  border-radius: 0.5rem;
  margin-bottom: 1rem;
}

.important>* {
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
}</style><script role="script" id="twine-user-script" type="text/twine-javascript">/** Story Constants */
story.version = "v0.3.1";

// Warm Place to Stay Message
console.log(`
========================================================

Hi there! Thanks for reading A Warm Place to Stay.

If you're snooping around in the dev console, it probably
means you're looking for some secret goodies or easter
eggs.

There's not really much hidden content to speak of yet,
but you can execute this command to enable debug commands.

storyFlags.assign({showDebug: true}); location.reload();

Those commands are mostly just for testing, but they'll
let you switch Zasha's gender, warp to any passage, and
spawn with 200 HP and all weapons.

Maybe not that last one, actually.

-AA

=========================================================
`)

/**
 * Snowbunny 0.2
 * A set of fairly specific tweaks, plugins, and helper functions for
 * Twine+Snowman-based games.
 */
window.bunny = window.bunny || {};

console.debug(`Initializing game ${bunny.storyVersion}`);

// Wraps the jQuery command to add event listeners on sm.passage.shown.
bunny.addPassageEventListener = (func) => $(window).on('sm.passage.shown', func);

/* DOM Manipulations */

// Move story-defined CSS into <head>, so that styles declared
// inside the passage body take higher priority.
$("tw-story > style").appendTo($("head"));

// Passage tags are applied to <body data-tags> for easy CSS styling.
bunny.addPassageEventListener(() => {
    $("body").attr("data-tags", passage.tags.join(" "));
    // Selector: body[data-tags~="mytag"]
});

/*
 * History Commands
 */

/**
 * Go back to the previous passage.
 * Returns true if the user is now on a different passage.
 */
bunny.undo = () => {
    let current_p = window.passage.id;
    window.history.back();
    return (current_p != window.passage.id);
}
/** Clear state, and return to start. */
bunny.restart = () => {
    // explicitly carry over the gender setting
    let g = story.state.g;
    story.state = {
        g
    };
    story.history = [];
    story.show(story.startPassage);
}
// save a Snowman checkpoint on every passage.
$(window).on('sm.passage.shown', (event, {
    passage
}) => {
    story.checkpoint(); // required for "undo" to restore previous state

});

// Add a fadein effect when loading passages.
// Can be disabled by adding the "no_fade" tag
$(window).on('sm.passage.shown', (event, {passage}) => {
    if (!passage.tags.includes("no_fade")) {
        $("tw-passage").css({
            opacity: 0
        }).animate({
            opacity: 1
        }, "slow")
    }
})
// When a new passage loads, scroll to the top and unfocus selection.
$(window).on('sm.passage.shown', (event, {
    passage
}) => {
    window.scrollTo({
        top: 0,
        left: 0,
        behavior: 'smooth'
    }); // scroll to top
    $(":focus").blur(); // deselect selected item
});
/** bunny.rerender
 * Rerenders the current passage, perserving focus.
 * Snowman doesn't support watched "live" variables, so this is useful
 * if you need a link to update a variable on the current page.
 */
bunny.rerender = () => {
    const focusIndex = controls.getFocusables()
        .index(document.activeElement);
    renderToSelector("tw-passage", passage.id);
    controls.getFocusables().eq(focusIndex).focus();
}

/*
 * DEBUG: Handle Snowman Errors without Crashing
 */
story.ignoreErrors = true;
$(window).on("sm.story.error", (event, error) => {
    if (story.ignoreErrors) {
        const message =
            `${error.message}
        ---
        Error occured while viewing "${window.passage ? passage.name : "undefined"}". Check debug console for for details.

        To report this bug, please message the developer with the following:
        1) What version is your browser?
        2) Steps to reproduce?
        3) A screenshot of the debug console
        `;
        window.alert(message);
        console.error(error);
    }
})
/*
 * DEBUG: Reset startpassage, even if Twine loaded from another passage.
 */
$(window).one("sm.passage.shown", (event, {
    passage
}) => {
    let index = story.passages.findIndex(e => e && e.tags.includes("start"));
    if (index != -1) {
        story.startPassage = index;
    }
})
/*
 * Keyboard Controls
 */
window.controls = window.controls || {}; {
    controls.getFocusables = () => $("a[href], button, input, select, [tabindex]").filter(":visible");

    controls.focusNext = () => {
        const $focusables = controls.getFocusables();
        let index = $focusables.index(document.activeElement);
        if (index != -1) {
            $focusables.eq(index + 1).focus();
        } else {
            if ($("tw-passage").find($focusables)[0]) {
                $("tw-passage").find($focusables).first().focus();
            } else {
                $focusables.first().focus();
            }
        }
    }
    controls.focusPrev = () => {
        const $focusables = controls.getFocusables();
        let index = $focusables.index(document.activeElement);
        if (index >= 0) {
            $focusables.eq(index - 1).focus();
        } else {
            controls.focusNext();
            controls.focusPrev();
        }
    }
    controls.selectFocused = () => {
        const $focusables = controls.getFocusables();
        if ($focusables.index(document.activeElement) != -1) {
            document.activeElement.click();
        } else {
            controls.focusNext();
        }
    }
    controls.goNext = () => {
        let p = passage.id;
        if (!$(":focus")[0]) {
            window.history.forward();
        }
        if (p == passage.id) {
            controls.selectFocused();
        }
    }
}
$(document).keydown(function (e) {
    if ($(e.target).is("input[type!='button'], [contenteditable]") &&
        !e.key.startsWith("Arrow")) {
        return;
    }
    switch (e.key.toLowerCase()) {
        case "enter":
        case "e":
        case " ":
            controls.selectFocused();
            e.preventDefault();
            break;
        case "h":
        case "a":
        case "arrowleft":
            bunny.undo();
            e.preventDefault();
            break;
        case "d":
        case "l":
        case "arrowright":
            controls.goNext();
            e.preventDefault();
            break;
        case "w":
        case "k":
        case "arrowup":
            controls.focusPrev();
            e.preventDefault();
            break;
        case "s":
        case "j":
        case "arrowdown":
            controls.focusNext();
            e.preventDefault();
            break;
    }
});

/**
 * A simple helper class, for storing arbitrary serialized objects and arrays in LocalStorage
 * Data is JSON encoded, and stored as base64 on the localStorage object.
 * Utilizes caching to minimize the number of encoding and decoding operations.
 * Full decode/encode is only performed when initializing, and when setting.
 */
window.BunnyStorage = class {
    constructor(id, defaultData = {}) {
        this.storageKey = id;
        // if no data exists, set the default
        if (this.get() == undefined) {
            this.set(defaultData);
        }
    }
    get() {
        if (!this._cached) {
            const raw = localStorage.getItem(this.storageKey);
            if (raw) {
                this._cached = JSON.parse(atob(raw));
            } else {
                this._cached = undefined;
            }
            return this._cached;
        }
        return this._cached;
    }
    set(data) {
        const json_encoded = JSON.stringify(data);
        this._cached = JSON.parse(json_encoded);
        const b64_encoded = btoa(json_encoded);
        localStorage.setItem(this.storageKey, b64_encoded);
    }
    add(...items) {
        if (Array.isArray(this.get())) {
            this.set([...this.get(), ...items])
        } else {
            throw Error("BunnyStorage.prototype.add can only be used if the stored object is an Array ");
        }
    }
    assign(obj) {
        if (!Array.isArray(this.get())) {
            this.set({
                ...this.get(),
                ...obj
            })
        }
    }
    clear() {
        localStorage.removeItem(this.storageKey);
        this._cached = undefined;
    }
}

window.storyFlags = new BunnyStorage("WP_flags", {});

console.debug("Initialized storyFlags")

// Sync history with storyflags
$(window).one("sm.story.started", () => {
    if (!Array.isArray(storyFlags.get().seenPassages)) {
        storyFlags.assign({
            seenPassages: []
        });
    }
    $(window).on("sm.passage.shown", (event, {passage}) => {
        let seen = storyFlags.get().seenPassages || [];
        if (!seen.includes(passage.id)) {
            storyFlags.assign({
                seenPassages: [...seen, passage.id]
            })
            if (passage.tags.includes("checkpoint")) {
                console.debug(`Visited checkpoint "${passage.name}" for the first time.`)
            }
        }
    });
});
// If Twine "test", enable the debug menu
if ($("tw-storydata").attr("options").includes("debug")) {
  storyFlags.assign({showDebug: true})
}

/*
 * Page Header
 * Render the passage with the "header" tag.
 * This should be more customizable, probably.
 */
bunny.$headerEl = $("<header></header>").attr("id", "header");
$(window).one('sm.story.started', function (event, {story}) {
    const headerPassage = story.passages.find(p => p && p.tags.includes("header")).id;
    renderToSelector(bunny.$headerEl, headerPassage);
    bunny.$headerEl.insertBefore(story.$passageEl);
});

/**
 * Previous Command
 * Use the text of the previously clicked link as the title for
 * the next passage. Inspired by MSPA.
 * Example: [[Foo|Bar]] goes to page "Foo"
 */
$("tw-passage").on("click", "a", ({
    currentTarget
}) => {
    const $this = $(currentTarget);
    // Data attributes:
    // Add data-nocommand to use the linked passage's title
    // Use data-command="..." to set custom titles
    const data = $this.data();
    if (data["command"] !== "" && data["nocommand"] !== "") {
        story.state.previousCommand = data["command"] || $this.html();
    }
    console.debug(`Clicked on "${story.state.previousCommand}"`)
});

$(window).on('sm.passage.shown', (e, {
    passage
}) => {
    const passageTitle = story.state.previousCommand || passage.name;
    $("#recent-command").html(passageTitle)
    story.state.previousCommand = "";
})</script><tw-tag name="flush" color="red"></tw-tag><tw-tag name="header" color="green"></tw-tag><tw-tag name="sidebar" color="green"></tw-tag><tw-tag name="vore" color="red"></tw-tag><tw-tag name="warm" color="red"></tw-tag><tw-tag name="check" color="orange"></tw-tag><tw-tag name="checkpoint" color="yellow"></tw-tag><tw-tag name="cold" color="blue"></tw-tag><tw-tag name="start" color="green"></tw-tag><tw-tag name="todo" color="orange"></tw-tag><tw-passagedata pid="1" name="Title Screen" tags="start" position="500,100" size="100,100">&lt;div.logo&gt;
&lt;h1 class=&quot;logotitle&quot;&gt;A Warm&amp;nbsp;Place to&amp;nbsp;Stay&lt;/h1&gt;
&lt;p.logosubtitle&gt;Polar Bear Vore Adventure by Double-A&lt;/p&gt;

&lt;p style=&quot;margin: 2rem 0;&quot;&gt;&gt; [[A Warm Place to Stay.]]&lt;/p&gt;

&lt;/div&gt;

&lt;style&gt;

#recent-command { display: none }
.logo {
  text-align: center;
  margin: 5rem 0;
}
.logotitle {
  font-family: &#39;Times New Roman&#39;, serif;
  font-variant: small-caps;
  font-weight: bold;
  font-size: 4rem;
  line-height: 1;
}
.logosubtitle {
  letter-spacing: 0.12em;
  text-transform: uppercase;
  font-weight: lighter;
}
&lt;/style&gt;

&lt;br&gt;

&lt;% let seen = storyFlags.get().seenPassages;
let checkpoints = story.passages
    .filter(p =&gt; p &amp;&amp; p.tags.includes(&quot;checkpoint&quot;))
	&lt;!-- .sort((p1, p2) =&gt; seen.indexOf(p1.id) -  seen.indexOf(p2.id)); --&gt;
let seenCount = checkpoints.filter(p =&gt; seen.includes(p.id)).length;
let unseenCount = checkpoints.filter(p =&gt; !seen.includes(p.id)).length;
	%&gt;

&lt;% if (seenCount &gt; 0) { %&gt;
&lt;div.important&gt;
&lt;h3&gt;Checkpoints&lt;/h3&gt;
&lt;ul style=&quot;list-style-type: &#39;&gt; &#39;;&quot;&gt;
&lt;% checkpoints.filter(p =&gt; seen.includes(p.id))
	.forEach(({ name, id }) =&gt; { %&gt;
&lt;li&gt;&lt;a0 data-passage=&quot;&lt;%=name%&gt;&quot;&gt;&lt;%= name %&gt;&lt;/a&gt;&lt;/li&gt;
&lt;% }); %&gt;
&lt;% for (let i = unseenCount; i &gt; 0; i--) { %&gt;
&lt;li&gt;?????&lt;/li&gt;
&lt;% } %&gt;
&lt;/ul&gt;

\&gt; &lt;a0 onclick=&quot;window.confirm(&#39;This will permanently reset checkpoints. Are you sure?&#39;) &amp;&amp; storyFlags.assign({seenPassages: []}); bunny.rerender()&quot;&gt;Reset checkpoints.&lt;/a&gt;

&lt;/div&gt;
&lt;% } else { %&gt;

&lt;div.important&gt;

####  CONTENT WARNING 

Vore. Furries. Unfinished content.

&lt;/div&gt;

&lt;% } %&gt;</tw-passagedata><tw-passagedata pid="2" name="Keyboard controls" tags="" position="700,100" size="100,100">This game can be played with either mouse or keyboard controls.

#### Basic Navigation

`W () ` *Select previous link.*

`S ()` *Select next link.*

`E ()` *Use selected link.*

#### Time Travel

`A ()` *Undo last command.*

`D ()` *Redo last command.*

\&gt; &lt;a0 onclick=&quot;bunny.undo()&quot;&gt;Go back.&lt;/a&gt;</tw-passagedata><tw-passagedata pid="3" name="Warp zone" tags="" position="1100,100" size="100,100">You&#39;ve entered a time warp!

This is a list of every passage, in the order they were added to the game.

To the right are passage tags, metadata which I use for things like checkpoints and background colors.

&lt;table class=&quot;table&quot;&gt;
&lt;thead&gt;
  &lt;tr&gt;
    &lt;th&gt;id&lt;/th&gt;
    &lt;th&gt;name&lt;/th&gt;
    &lt;th&gt;tags&lt;/th&gt;
	&lt;th&gt;seen?&lt;/th&gt;
  &lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
  &lt;%
  let seen = storyFlags.get().seenPassages;
  story.passages.map(({ id, name, tags }) =&gt; { %&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;%-id%&gt;&lt;/td&gt;
	&lt;td&gt;&lt;a0 data-passage=&quot;&lt;%=name%&gt;&quot;&gt;&lt;%= name %&gt;&lt;/a&gt;&lt;/td&gt;
    &lt;td&gt;&lt;% tags.map(t =&gt; { %&gt;&lt;span class=&quot;tag-badge&quot;
  color=&quot;&lt;%-$(`tw-tag[name=${t}]`).attr(&#39;color&#39;)%&gt;&quot;&gt;&lt;%-t%&gt;&lt;/span&gt;
  &lt;% }) %&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%-seen.includes(id) ? &quot;&quot; : &quot;&quot;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;% }); %&gt;
&lt;/tbody&gt;
&lt;/table&gt;


&lt;/table&gt;

&lt;style&gt;

.table {
}

.tag-badge {
  display: inline-block;
  background-color: #555;
  border-radius: 0.25rem;
  padding: 0 0.25rem;
  font-size: small;
  color: white;
}
.tag-badge[color=yellow] {
	background-color: #fc1;
	color: #111;
}
.tag-badge[color=red] {
	background-color: #d34;
}
.tag-badge[color=blue] {
	background-color: #1ab;
}
.tag-badge[color=green] {
	background-color: #2a4;
}

.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 1rem;
  background-color: transparent;
  border: 1px solid #dee2e6;
  padding: 0.5rem;
  border-radius: 0.5rem;
}

.table th,
.table td {
  padding: 0.25rem;
  vertical-align: top;
  border-bottom: 1px solid #dee2e6;
}

.table thead th {
  vertical-align: bottom;
  border-bottom: 2px solid #dee2e6;
  text-align: inherit;
}
&lt;/style&gt;</tw-passagedata><tw-passagedata pid="4" name="Header" tags="header" position="200,100" size="100,100">&lt;% if (storyFlags.get().showDebug) { %&gt;
&lt;div class=&quot;debug-menu&quot;&gt;
&lt;style&gt;
.debug-menu {
  position: fixed;
  top: 0;
  left: 0;
  font-size: 0.75em;
  margin: 1rem;
  background: #fff;
  padding: 1rem;
  border: 1px solid var(--light);
}
&lt;/style&gt;
&lt;p&gt;DEBUG COMMANDS&lt;/p&gt;
&lt;ul style=&quot;list-style-type: &#39;&gt; &#39;;&quot;&gt;
  &lt;li&gt;
    &lt;a0
	  onclick=&quot;story.state.g = !story.state.g; bunny.rerender()&quot;&gt;
	  Toggle gender
	&lt;/a&gt;
  &lt;/li&gt;
  &lt;li&gt;[[Warp zone]]&lt;/li&gt;
  &lt;li&gt;
    &lt;a0
	  onclick=&quot;window.confirm(&#39;This will fully reset all persistent game data. It will also disable debug mode.&#39;)
	  &amp;&amp; (storyFlags.clear(), location.reload());&quot;&gt;
	  Reset Savegame
	  &lt;/a&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;% } %&gt;

&lt;div.topbar&gt;
  &lt;div.header-nav&gt;
	&lt;div.header-nav-group&gt;
	  &lt;div&gt;&lt;a0 onclick=&quot;bunny.restart()&quot;&gt;Restart&lt;/a&gt;
	  &lt;/div&gt;
	  &lt;div&gt;&lt;a0 onclick=&quot;bunny.undo()&quot;&gt;Undo&lt;/a&gt;
	  &lt;/div&gt;
	&lt;/div&gt;
	&lt;div.header-nav-group&gt;
	  &lt;div&gt;[[Keyboard controls]]&lt;/div&gt;
	  &lt;span&gt;&lt;%= story.version %&gt;&lt;/span&gt;
	&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&quot;recent-command&quot;&gt;&lt;/h2&gt;

&lt;style&gt;
  .topbar {
    font-size: 0.75em;
    border-bottom: 1px solid var(--light);
    padding-bottom: 1rem;
    margin-bottom: 1rem;
  }
  .header-nav {
    display: flex;
	justify-content: space-between;
  }

  .header-nav-group &gt; * {
    display: inline-block;
    margin-bottom: 0;
  }

  .header-nav-group &gt; * + * {
    margin-left: 0.5rem;
  }

  .header-nav-group &gt; * + *::before {
    content: &quot;|&quot;;
    margin-right: 0.5rem;
  }
&lt;/style&gt;</tw-passagedata><tw-passagedata pid="5" name="Adventure Log" tags="" position="900,100" size="100,100">A list of all the passages the user has seen, in the order they were discovered.

This code might be useful for some kind of sidebar?

&lt;% let seen = storyFlags.get().seenPassages;
let checkpoints = story.passages
	.filter(p =&gt; p &amp;&amp; seen.includes(p.id))
	.sort((p1, p2) =&gt; seen.indexOf(p1.id) -  seen.indexOf(p2.id)); %&gt;

&lt;% if (checkpoints.length &gt; 0) { %&gt;
&lt;ul style=&quot;list-style-type: &#39;&gt; &#39;;&quot;&gt;
&lt;% checkpoints.map(({ name }) =&gt; { %&gt;
&lt;li&gt;&lt;a0 data-passage=&quot;&lt;%=name%&gt;&quot;&gt;&lt;%= name %&gt;&lt;/a&gt;&lt;/li&gt;
&lt;% }); %&gt;
&lt;/ul&gt;

\&gt; &lt;a0 onclick=&quot;window.confirm(&#39;This will permanently reset checkpoints. Are you sure?&#39;) &amp;&amp; storyFlags.assign({seenPassages: []}); bunny.rerender()&quot;&gt;Reset checkpoints.&lt;/a&gt;

&lt;% } %&gt;</tw-passagedata><tw-passagedata pid="6" name="A Warm Place to Stay." tags="cold" position="500,225" size="100,100">&lt;style&gt;
body { transition: opacity 2s, background-color 0s; }
&lt;/style&gt;

Your name is Juniper Greenall. You are a rabbit.

You&#39;re in the driver&#39;s seat of a small car on the side of the road. An empty, snowy expanse surrounds you in every direction. Flecks of powdery white quickly accumulate on your windshield, as if threatening to swallow you whole. Despite your windshield wipers&#39; best efforts, the snow is gradually engulfing your view.

According to your stereo, it&#39;s 7:&lt;%= (new Date().getMinutes() &lt; 10 ? &quot;0&quot;:&quot;&quot;) + new Date().getMinutes()%&gt; PM.

\&gt; [[Take inventory.]]</tw-passagedata><tw-passagedata pid="7" name="Take inventory." tags="cold" position="500,350" size="100,100">An hour ago, you were driving down a narrow highway, on your way across the state of Northaven. The falling snow started out light, but got heavier and heaver. You struck a patch of black ice, swerved off the road, and got a flat tire in the process. Now you&#39;re stuck, sitting inside a tiny sedan in a ditch on the side of the road in the middle of nowhere, with little hope of rescue.

In your handbag, you have a cell phone, a credit card, a rewards card for a drive-thru coffee chain, and a wallet containing seven (7) dollars.

What will you do?

&lt;%= story.render(&quot;Car Commands&quot;) %&gt;

&lt;div-&gt;[[Car Commands]]&lt;/div&gt;</tw-passagedata><tw-passagedata pid="8" name="Car Commands" tags="" position="500,475" size="100,100">&lt;%
const carPassages = [&quot;Try calling for help.&quot;, &quot;Check for spare tire.&quot;, &quot;Turn on hazards.&quot;];
const seenEvery = carPassages.every(p =&gt; visited(p)); %&gt;

&lt;%= seenEvery ? &quot;Well, you&#39;re officially out of ideas.&quot; : &quot;&quot; %&gt;

&lt;% carPassages.map(p =&gt; {
  if (!visited(p)) { %&gt;

\&gt; &lt;a0 data-passage=&quot;&lt;%=p%&gt;&quot;&gt;&lt;%=p%&gt;&lt;/a&gt;

&lt;% }
}); %&gt;

&lt;% if (seenEvery) { %&gt;

\&gt; [[Await slow and chilly death.]]

&lt;% } %&gt;

&lt;div-&gt;[[Try calling for help.]][[Check for spare tire.]][[Turn on hazards.]]&lt;/div&gt;</tw-passagedata><tw-passagedata pid="9" name="Try calling for help." tags="cold" position="375,600" size="100,100">Yep, already tried &lt;%= visited(&quot;Check for spare tire.&quot;) ? &quot;that too.&quot; : &quot;that.&quot; %&gt;

You pull out your little cell phone, if only confirm that it still has no reception. You wave it around in the air for a moment, trying to get a signal. No dice.

Either the snowstorm is messing with the cell towers, or the cellular infrastructure of rural Northaven simply leaves a lot to be desired.

&lt;%= story.render(&quot;Car Commands&quot;) %&gt;</tw-passagedata><tw-passagedata pid="10" name="Check for spare tire." tags="cold" position="500,600" size="100,100">Good thinking. Unfortunately, you&#39;ve actually been driving on the spare for the last year or so. Come to think of it, that might be why it gave out so easily.

Well, hindsight&#39;s 20/20, and all.

&lt;%= story.render(&quot;Car Commands&quot;) %&gt;</tw-passagedata><tw-passagedata pid="11" name="Turn on hazards." tags="cold" position="625,600" size="100,100">You do that. If youre lucky, someone might notice and help you out. Of course that would require someone to actually be driving on this road, which, in your experience so far, does not happen very often. You havent seen another car in over 20 minutes.

Well, you&#39;re officially out of ideas.

\&gt; [[Await slow and chilly death.]]</tw-passagedata><tw-passagedata pid="12" name="Await slow and chilly death." tags="cold" position="500,725" size="100,100">Your fuzzy ears droop behind your head in sorrow, and you resign to your inevitable, icy fate. The cruel reality of your situation sinks in. You can feel the clutches of frostbite already taking hold of...

Okay, you&#39;re being kind of dramatic. You&#39;re not gonna die; you&#39;ve got fur to keep you warm, not to mention the car&#39;s heater. In the worst case, you&#39;ll just have to wait the storm out. Still, it&#39;s not how you expected to spend tonight.

If you&#39;d known you were going to get stuck in a snowstorm, you might have at least worn some pants today.

\&gt; [[Wait, I&#39;m not wearing pants?]]</tw-passagedata><tw-passagedata pid="13" name="Wait, I&#39;m not wearing pants?" tags="cold" position="500,850" size="100,100">No, of course you&#39;re not. What a silly thing for you to wonder.

You, Juniper Greenall, are a rabbit living in a society of anthropomorphic mammals. Like most people, you are furry enough &quot;down there&quot; that you don&#39;t consider pants to be a necessary garment, except on especially formal occasions. As long as you&#39;re wearing either a top or a bottom, (in your case, a jacket and a plain undershirt) you&#39;re fully clothed. Porky Pig-style.

It&#39;s gonna be a long night. There will be plenty of time to think about the societal implications of this when you&#39;re-

*VrooOOOOoom.*

\&gt; [[What was that?]]</tw-passagedata><tw-passagedata pid="14" name="What was that?" tags="cold checkpoint" position="500,1150" size="100,100">Outside, you hear an engine roar and come to a stop. Your windshield is almost too caked in snow to make it out, but you can just barely see a huge pickup truck as it pulls off the road and parks in front of you.

From the truck, a huge, broad-shouldered figure emerges, and begins to trudge through the snow toward your car. Great. You&#39;re either about to be rescued, or violently abducted.

You hear a knock to your left. You sweat a bit, and turn your head extremely slowly to see...

A polar bear in a puffy winter coat. They&#39;re standing outside your car and politely tapping on the driver&#39;s side window with an enormous white paw.

&lt;div.commands.important&gt;

\&gt; &lt;a0 data-passage=&quot;Just ignore.&quot; onclick=&quot;story.state.g = true;&quot;&gt;Just ignore him.&lt;/a&gt; *(Male Pred)*

\&gt; &lt;a0 data-passage=&quot;Just ignore.&quot; onclick=&quot;story.state.g = false;&quot;&gt;Just ignore her.&lt;/a&gt; *(Female Pred)*

&lt;/div&gt;

&lt;div-&gt;[[Just ignore.]]&lt;/div&gt;</tw-passagedata><tw-passagedata pid="15" name="Just ignore." tags="cold" position="500,1275" size="100,100">Faced with the sudden appearance of a potential predator, your natural instincts kick in. You go perfectly still, ignoring the polar bear completely.

This probably won&#39;t help. Not only has &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; already seen you, but &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt;&#39;s probably not a predator either. Bearsand most carnivores in generalare not ravenous murderers who devour any stranger they come across. Eating people is, in fact, quite frowned upon. Unsolicited predation is extremely uncommon, although the news headlines tend to blow it out of proportion.

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; stares somewhat awkwardly at you for a moment, taps on the glass, and calls out, &quot;Hello? Does rabbit need help?&quot;

&lt;div.commands&gt;

\&gt; [[Keep ignoring &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;.|Keep ignoring.]]

\&gt; [[Roll the window down.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="16" name="Keep ignoring." tags="cold" position="625,1300" size="100,100">You continue paying no attention to the polar bear. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; scratches &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; head awkwardly.

Okay, this is stupid, and also kind of speciesist? This bear is your only hope of rescue, and &lt;%=s.g?&quot;he&#39;s&quot;:&quot;she&#39;s&quot;%&gt; probably a well-adjusted, perfectly ordinary person, content to eat a civilized diet of fish and dairy. Despite what your &quot;old-fashioned&quot; parents would think, bears are not all rabbit-gulping vore machines. Try to be a little more open minded.

The polar bear taps on your window again. &quot;Er, is rabbit okay? Should I go?&quot;

You&#39;re gonna be here all night if you don&#39;t talk to &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;.

\&gt; [[Roll the window down.]]</tw-passagedata><tw-passagedata pid="17" name="Roll the window down." tags="cold" position="500,1425" size="100,100">Drafty, snowy air blows in. The polar bear crouches down to peer at you through the open window. You finally get a better look at &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;.

Most notably, &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt;&#39;s huge. &lt;%=s.g?&quot;His&quot;:&quot;Her&quot;%&gt; bear-sized face almost fully eclipses the window of your decidedly rabbit-sized car.
&lt;%=s.g?&quot;His&quot;:&quot;Her&quot;%&gt; &quot;robust&quot; figure is only widened by the thick blue winter coat &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt;&#39;s wearing. And as we established earlier, no pants. You get the feeling that the people in this world have very different standards of modesty. And by &quot;get the feeling,&quot; you mean you&#39;ve known this all along.

You&#39;d probably be more intimidated by this huge hunk of &lt;%=s.g?&quot;muscle&quot;:&quot;fat&quot;%&gt;  and fur, but there&#39;s something soft and non-threatening about &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; chestnut colored eyes. You feel somewhat calmed by &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; presence.

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; clears &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; throat. &quot;I saw blinker,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says in a thick northern accent, &quot;You require assistance?&quot;

&lt;div.commands.important&gt;

\&gt; [[Yes, I do need help actually...]] *(Route 1)*

\&gt; [[Jump down &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; throat.|Jump down their throat.]] *(Route 2)*

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="18" name="Yes, I do need help actually..." tags="cold" position="500,1550" size="100,100">Yes, you say, you&#39;ve got a flat tire, and you&#39;re stuck here.

The bear pauses thoughtfully. &quot;You have spare?&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; asks. You shake your head no. &quot;Hmm,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says with a paw on &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; chin, &quot;Snow too heavy. Can&#39;t move car right now.&quot;

Your ears droop, crestfallen.

&quot;However, I am on way to hotel,&quot; Zasha continues, &quot;Warm place for night, few miles. You wish to ride there with me?&quot;

Your eyes go wide. A ride to a hotel? That&#39;s actually extremely convenient! But, should you go with &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;? Growing up as a rabbit, you were taught never to accept rides from strangers,  especially strangers who are theoretically large enough to swallow you whole without a thought.

Then again, the alternative is spending all night in a chilly car, so you probably better accept.

\&gt; [[Hitch a ride.]]</tw-passagedata><tw-passagedata pid="19" name="Hitch a ride." tags="cold" position="500,1675" size="100,100">Yes, you say, you could use a lift.

&quot;Good,&quot; the bear says, &quot;I am glad to assist with such a thing. Come when you are ready.&quot; &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; walks back to &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; car, and opens the passenger door for you.

You grab up your belongings, including your phone, keys, and the little shoulder bag where you usually carry them. You climb out and lock your car, hopefully to return to it tomorrow.

The frigid snow nips at your paw-pads and makes you wince. You&#39;re clearly not used to this kind of weather. You high-tail it into the passenger seat of the polar bear&#39;s enormous four-seat pickup truck, and slam the door behind you, shivering. The polar bear climbs in the other side, notices your discomfort, and cranks the heat up to full blast.

Th-thanks, you stammer.

&quot;It is no trouble, Rabbit,&quot; says the polar bear, &quot;Sorry about mess in here. We will be at hotel soon.&quot; You nod, and &lt;%=s.g?&#39;he&#39;:&#39;she&#39;%&gt; pulls back onto the highway, and starts driving.

&lt;div.commands&gt;

\&gt; [[Look out the window.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="20" name="Look out the window." tags="cold" position="500,1800" size="100,100">The two of you sit in awkward silence for a little bit, as the polar bear carefully drives the two of you down the narrow highway covered in snowy sludge. Occasionally a dense patch of fir trees passes by. You twiddle your paws. The seatbelts in this vehicle are way too large for your little body.

&quot;Rabbit is not a talkative one, yes?&quot; the bear observes.

Oh, s-sorry! you say. You&#39;ve just had a long day.

&quot;I did not mean this to insult,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says, &quot;My kind is solitary as well.&quot;

In truth, you were distracted, thinking about how powerless you&#39;d be to stop such a hulking carnivore from grabbing and devouring you. Every time &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; speaks, &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; black lips expose four pearly white fangs, and a big pink tongue. It&#39;s scary, but mostly it makes you feel... strangely enticed.

&quot;To think lot and say little is a virtue,&quot; the polar bear continues, &quot;However, I believe it is polite that I should know your name?&quot;

&lt;div.commands&gt;

\&gt; [[Of course! My name is...]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="21" name="Of course! My name is..." tags="cold" position="500,1925" size="100,100">&quot;Juniper. Hm. This is a sweet sounding name. It reminds me of winter meals in my home,&quot; says the polar bear. &quot;My name is Zasha, protector of creatures large and small.&quot;

You nod, then return to awkwardly twiddling your paws. Zasha also says nothing.  You&#39;ve never hitch-hiked before, so you&#39;re not very good at the small-talk. You&#39;re also very intimidated by the gigantic polar bear who has offered you help.

...Some weather, huh? you say.

&quot;Yes,&quot; Zasha says, &quot;the snowing is not usually so strong this time of year. It is terrible that you were stranded.&quot;

&lt;div.commands&gt;

\&gt; [[Do you live around here?]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="22" name="Do you live around here?" tags="cold checkpoint" position="500,2050" size="100,100">&quot;Not especially,&quot; says Zasha. &quot;Zasha considers &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;self as nomad. Often moving from place to place. Tonight staying in hotel on way east, for next job.&quot;

You nod, glancing around the truck&#39;s interior, until your eyes fix on a metal toolbox on the floor by your feet. You hope it&#39;s not too personal a question, but what does &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; do for a living?

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; hesitates and says, &quot;Er, Zasha is a... travelling repair&lt;%=s.g?&quot;man&quot;:&quot;woman&quot;%&gt;!&quot;

&lt;div.commands.important&gt;

\&gt; [[Nod agreeably.]] *(Route 1)*

\&gt; [[Press for more information.]] *(Route 3)*

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="23" name="Nod agreeably." tags="cold" position="500,2175" size="100,100">Yup, nothing suspicious there.

&quot;And you?&quot; Zasha asks, &quot;If you do not mind, where is Juniper headed?&quot;

Oh, you know, just passing through. It&#39;s not important. Probably some kind of business meeting or something.

Zasha nods, eager to change the subject. You ride together in silence for a minute or so. &lt;%= story.render(&quot;Arrive at the hotel.&quot;)%&gt;

&lt;div-&gt;[[Arrive at the hotel.]]&lt;/div&gt;</tw-passagedata><tw-passagedata pid="24" name="Arrive at the hotel." tags="cold" position="500,2300" size="100,100">Scenery whizzes past. Eventually Zasha turns off the road, and into the parking lot of a roadside hotel, just as promised. It&#39;s a meager two-story lodge, probably converted from an old house or something. It&#39;s meager, but in a quaint, charming way.

\&gt; [[Get out of the truck.]]</tw-passagedata><tw-passagedata pid="25" name="Get out of the truck." tags="cold" position="500,2300" size="100,100">You shudder as you step outside into the chilly air. The entrance is only a short walk away, but in this cold, it feels like a million miles.

Zasha notices your discomfort, and frowns. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; holds open &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; puffy coat to reveal the fur of &lt;%=s.g?&quot;his bare&quot;:&quot;her naked&quot;%&gt; belly and chest, as if inviting you to huddle against it for warmth. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt;&#39;s... not wearing anything underneath. You feel your cheeks redden, either from embarassment, or from the sheer cold nipping at them.

&quot;Rabbit,&quot; Zasha says, &quot;you will wish to stay warm in this weather, yes?&quot;

&lt;div.commands.important&gt;

\&gt; [[Cozy up inside Zasha&#39;s coat.]]

\&gt; [[Tough it out.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="26" name="Cozy up inside Zasha&#39;s coat." tags="warm" position="500,2550" size="100,100">&lt;% console.debug(`Set s.snuggled_up from ${s.snuggled_up} to true.`);
s.snuggled_up = true %&gt;

You blush, and reluctantly step into the inviting warmth of Zasha&#39;s fur. It&#39;s unbelievably soft. You cozy up against it, and &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; considerately pulls &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; jacket around you, almost as if to squeeze you tighter against &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;. Zasha begins guiding the two of you through the parking lot.

The polar bear&#39;s pudgy gut jiggles a little with each step. Normally, you&#39;d feel nervous about being so close to a bearnot to mention, a bear&#39;s stomachbut it&#39;s so bitterly cold out, you can only feel grateful for this warm gesture. &lt;%=s.g?&quot;His&quot;:&quot;Her&quot;%&gt; fur is softer than you could have imagined.

\&gt; [[Th-thank you...|Thanks for the warmth.]]</tw-passagedata><tw-passagedata pid="27" name="Thanks for the warmth." tags="warm" position="500,2675" size="100,100">Thank you, you tell Zasha, poking your head out to see where you&#39;re going.

&quot;There is no need for such gratitudes, Rabbit,&quot; Zasha says, still looking ahead, &quot;it is duty of a bear to help all creatures.&quot;

You remind Zasha that your name is Juniper, not Rabbit. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; repeats it to commit it to memory. The two of you finally make it to the door.

The automatic doors have seen better days, but they slowly and creakily slide open, bringing in a little draft into the lobby. Zasha opens &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; jacket to release you into the warm air of the lobby. You reluctantly step away, and dust a few white hairs from your jacket.

\&gt; [[Enter the hotel.]]</tw-passagedata><tw-passagedata pid="28" name="Tough it out." tags="cold" position="625,2550" size="100,100">You politely refuse the gesture, and walk quickly and purposefully to the door, wincing as icy pain attacks the pads of your feet. Zasha trails behind at a plodding pace, dragging with &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt; a large, boxy suitcase. By the time you make it to the hotel&#39;s entrance, your teeth are already chattering.

The automatic sliding doors look really old. You walk up to them, but they do not detect your presence. You impatiently wave a hand around, but can&#39;t get the sensor to trip. When it finally does sense you, the door opens a few inches, then slows to a creaking halt. Wow, you&#39;re 02 for mechanical failures today, huh.

Zasha sees the door failing to open, and sees you shuddering and rubbing your shoulders for warmth. A &lt;%=s.g?&quot;paternal&quot;:&quot;maternal&quot;%&gt; instinct seems to take hold. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; walks right up to the sliding doors, examines them for a moment, and with loud grunt, forces one of them aside with &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; bare paws. It resists for a moment, but ultimately gives way.

&quot;There we go,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says, &quot;silly machine no match for Zasha.&quot; &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; gestures for you to enter.

\&gt; [[Enter the hotel.]]</tw-passagedata><tw-passagedata pid="29" name="Enter the hotel." tags="" position="500,2800" size="100,100">The hotel lobby is small and quaint, containing a short desk with a bell, and another table covered in little pamphlets advertising nearby curiosities. A bored-looking fox in a concierge&#39;s uniform is sitting at the desk. Across from the desk is an elevator which is currently out of order. To the left is a hallway which presumably leads to the hotel&#39;s rooms.

You take a quick breather while Zasha checks into &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; reservation. You&#39;re glad you have your credit card with you. You&#39;ll book a room after &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;.

You see the concierge give Zasha a couple of room keys. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; turns around, and places a friendly paw on your shoulder.

&quot;&lt;%= s.snuggled_up ? &quot;Juniper&quot; : &quot;Rabbit&quot;%&gt;, do you wish to sleep with me in my hotel room?&quot;

\&gt; [[W-what?]]</tw-passagedata><tw-passagedata pid="30" name="W-what?" tags="warm" position="500,2925" size="100,100">Your face flushes, and your ears stick straight up with surprise. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; wants to sleep with you??

You stammer to say that s-sorry, you don&#39;t think of &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt; that way! &lt;%= s.snuggled_up ? `Even considering how warm ${s.g?&quot;his&quot;:&quot;her&quot;} fur was...`:`Though you&#39;re very thankful that ${s.g?&quot;he&quot;:&quot;she&quot;} rescued you!`%&gt;

Zasha&#39;s eyes go wide as &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; realizes &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; mistake. &quot;Oh! I did not intend to suggest such a... prurient thing! I simply offer for you to sleep in my hotel room at no cost to you.&quot;

\&gt; [[Oh! Of course, ha-ha.]]</tw-passagedata><tw-passagedata pid="31" name="Oh! Of course, ha-ha." tags="" position="500,3050" size="100,100">You laugh awkwardly. Right, that&#39;s what you thought &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; meant too. Obviously.

&quot;Would you like to share room with me,&quot; asks Zasha, clearly&amp;nbsp;somewhat flustered.

You&#39;re not overly tempted to accept &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; offer. You&#39;ve got nothing against Zasha, but you&#39;re still hesitant about spending the night with a 700 pound polar bear who could eat you in &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; sleep? Not to mention, you already feel guilty for accepting so much help.

&lt;%= s.snuggled_up ? `${s.g?&quot;His&quot;:&quot;Her&quot;} fur *was* extremely warm and cuddly,` : `${s.g?&quot;He&quot;:&quot;She&quot;} seems harmless enough,`%&gt; but you&#39;d feel much better if you just got your own room.

&lt;div.commands&gt;

\&gt; [[Politely refuse.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="32" name="Politely refuse." tags="" position="500,3200" size="100,100">You tell Zasha that you really appreciate all the help &lt;%=s.g?&#39;he&#39;:&#39;she&#39;%&gt;&#39;s provided, but that you can handle it from here. You&#39;ll just book yourself a room, and get your car towed tomorrow.

&lt;%=s.g?&#39;He&#39;:&#39;She&#39;%&gt; seems kind of crestfallen, but nods in agreement.

But, you say, um, is there any way you can repay &lt;%=s.g?&#39;him&#39;:&#39;her&#39;%&gt;? You don&#39;t have much cash, but maybe you could Venmo &lt;%=s.g?&#39;him&#39;:&#39;her&#39;%&gt; as thanks for the ride? If you weren&#39;t in the middle of a snowstorm, you&#39;d offer to buy &lt;%=s.g?&#39;him&#39;:&#39;her&#39;%&gt; dinner somewhere... J-just dinner! Not like a date or anything!

&lt;%=s.g?&#39;He&#39;:&#39;She&#39;%&gt; shakes &lt;%=s.g?&#39;his&#39;:&#39;her&#39;%&gt; head firmly. &quot;No such repayment is necessary. I only do my part to protect all creatures. Farewell, &lt;%= s.snuggled_up ? &quot;Rabbit- erm, Juniper.&quot; : &quot;Rabbit&quot;%&gt;.&quot;

You graciously wave adieu to Zasha, then turn to the concierge to get your own room situation sorted.

\&gt; [[Talk to the concierge.]]</tw-passagedata><tw-passagedata pid="33" name="Talk to the concierge." tags="" position="500,3350" size="100,100">You stride confidently toward the concierge&#39;s desk. &lt;%=!s.g?&quot;He&quot;:&quot;She&quot;%&gt;&#39;s a red &lt;%=!s.g?&quot;fox&quot;:&quot;vixen&quot;%&gt;, and it seems as though the two of you have interrupted &lt;%=!s.g?&quot;his&quot;:&quot;her&quot;%&gt; extremely important perusal of a fashion magazine.

Hello, you say! You&#39;re looking to book a-

&quot;No vacancies,&quot; says the concierge immediately, pointing to a convenient sign above &lt;%=!s.g?&quot;his&quot;:&quot;her&quot;%&gt; head, which you did not notice until right now. Wow.

&lt;div.commands&gt;

\&gt; [[You&#39;re sure that there aren&#39;t any other rooms?]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="34" name="You&#39;re sure that there aren&#39;t any other rooms?" tags="" position="500,3500" size="100,100">The concierge looks at you, then back at the sign as if pretending to double-check.

&quot;Yup,&quot; &lt;%=!s.g?&quot;he&quot;:&quot;she&quot;%&gt; shrugs, &quot;This is a pretty small hotel. You&#39;re not the only ones trying to wait out the storm.&quot; &lt;%=!s.g?&quot;He&quot;:&quot;She&quot;%&gt; &lt;%= s.snuggled_up ? `notices Zasha&#39;s fur on your jacket` : `sniffs the air slightly`%&gt;, and quietly asks with a bemused smirk, &quot;Why don&#39;t you just stay with your &lt;%=s.g?&quot;boyfriend&quot;:&quot;girlfriend&quot;%&gt; over there? Scared &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt;&#39;ll get *hungry?*&quot;

Your ears stick straight up. You quickly stammer, *&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; is not my &lt;%=s.g?&quot;bo&quot;:&quot;gi&quot;%&gt;-*

Suddenly, you feel Zasha put &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; paw on your shoulder. &quot;No vacancies? This is not a problem,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says, brandishing a key-card from a coat pocket, &quot;The rabbit shall stay in my room, yes?&quot; &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; offers you the card.

I mean, it&#39;s not like you really have any other options?

\&gt; [[Freeze to death outside?]]

\&gt; [[Construct makeshift bed from travel pamphlets?]]</tw-passagedata><tw-passagedata pid="35" name="Freeze to death outside?" tags="" position="450,3700" size="100,100">You glance back toward the snowy wasteland outside the warm confines of the hotel lobby. Not your best idea.

\&gt; [[Accept the key-card.]]

&lt;% if (!visited(&quot;Construct makeshift bed from travel pamphlets?&quot;)) { %&gt;

\&gt; [[Construct makeshift bed from travel pamphlets?]]

&lt;% } %&gt;</tw-passagedata><tw-passagedata pid="36" name="Construct makeshift bed from travel pamphlets?" tags="" position="575,3700" size="100,100">Maybe if you stole enough of those little brochures, you could use them as a blanket?

You&#39;re just gonna have to share a room with this bear.

\&gt; [[Accept the key-card.]]

&lt;% if (!visited(&quot;Freeze to death outside?&quot;)) { %&gt;

\&gt; [[Freeze to death outside?]]

&lt;% } %&gt;</tw-passagedata><tw-passagedata pid="37" name="Accept the key-card." tags="" position="500,3875" size="100,100">&lt;%
console.debug(`Set s.got_the_key_card from ${s.got_the_key_card} to true.`)
s.got_the_key_card = true %&gt;

You accept Zasha&#39;s generous offer to share &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; hotel room. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; delicately hands you &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; spare key-card, which has been marked for Room 7.

&quot;I am glad to be of assistance, Rabbit. Come along when you are ready.&quot;

Zasha turns and heads for the hallway where the room is.

&lt;div.commands&gt;

\&gt; [[Follow Zasha to the room.]]

\&gt; [[Ask the concierge about towing your car.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="38" name="Ask the concierge about towing your car." tags="" position="500,4000" size="100,100">You have a brief but scintilliating conversation with the concierge about how your car is stuck in the snow four miles from here, a fact that no one really seems to care much about but you.

&quot;Sorry pal,&quot; &lt;%=s.g?&quot;she&quot;:&quot;he&quot;%&gt; says, &quot;You could try calling someone, but everything&#39;s probably gonna be shut down &#39;til tomorrow.&quot;

You ask, Because of the snow-

&quot;Because of the snowstorm,&quot; the &lt;%=s.g?&quot;vixen&quot;:&quot;fox&quot;%&gt; says.

...Cool, you say. You decide to deal with that problem in the morning.

\&gt; [[Follow Zasha to the room.]]</tw-passagedata><tw-passagedata pid="39" name="Follow Zasha to the room." tags="checkpoint" position="500,4125" size="100,100">&lt;%if (s.snuggled_up) { %&gt;
Zasha is waiting for you.

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; extends a paw, which you take, and leads you down the hallway as if you were a tiny cub. It&#39;s a little humiliating. You&#39;re a grown adult after all, and more than capable of finding a room in this tiny hotel yourself. But at the same time, it&#39;s kind of cute? Zasha&#39;s stubby white tail is wagging.
&lt;% } else { %&gt;
&quot;Follow me, Rabbit.&quot;

You follow Zasha down the hall. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt;&#39;s hunching &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; neck slightly, and you realize the ceiling here might be slightly too short for a polar bear of &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; size.
&lt;% } %&gt;

You stop in front of Room 7, right at the end of the hallway. &lt;% if (s.snuggled_up) {%&gt;Zasha lets go of your paw, bashfully.&lt;%}%&gt; Next to the door is a couple of vending machines which pique your interest. You rifle through your little purse, and find the seven (7) dollars from earlier.

The first one&#39;s a hot beverage maker. The other seems to dispense microwaveable frozen dinners. You wonderas you&#39;ve been wondering since you met &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;is Zasha hungry?

&lt;div.commands.important&gt;

\&gt; [[Offer to buy &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt; a meal.|Offer to buy a meal.]] *(Route 2a)*

\&gt; [[Buy yourself some tea to warm up.]] *(Route 2b)*

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="40" name="Offer to buy a meal." tags="" position="425,4275" size="100,100">&lt;% s.got_dinner = true; %&gt;

&lt;%
console.debug(`Set s.snuggled_up from ${s.got_dinner} to true.`);
s.got_dinner = true %&gt;

You gesture to the frozen dinner machine, and offer to buy Zasha something to eat.

As if reacting to the mere mention of food, &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; stomach lets out a low grumble. Geez, now you&#39;re afraid of what might have happened if you hadn&#39;t asked.

&quot;Yes,&quot; says Zasha, &quot;I suppose I have not eaten much today at all.&quot; &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; studies the machine for a moment, then points to the meal &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; wants.

You feed your cash in, and the machine gracefully ejects a large plastic tub: Lemon Risotto with Green Beans and Salmon. As a vegetarian, you can&#39;t help but turn up your nose slightly.

You take the container, and follow the enormous bear into Room 7. Zasha is unabashedly wagging &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; stubby white tail, as if utterly overjoyed at your simple gesture of buying &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt; dinner.

\&gt; [[Enter the hotel room.|Enter the hotel room. (Dinner Route)]]</tw-passagedata><tw-passagedata pid="41" name="Enter the hotel room. (Dinner Route)" tags="checkpoint" position="425,4425" size="100,100">&lt;div.important&gt;
This route is unfinished! It&#39;s playable, but is still written as an outline and may be missing content.
&lt;/div&gt;

You and Zasha have a pleasant meal. Zasha shares &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; green beans with you. The two of you learn more about each other, laughing, and enjoying the night. You admit to Zasha that at first, you were worried &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; would eat you! &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; laughs and dismisses the thought.

Zasha offers to share the tiny bed with you, and you feel comfortable enough around &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt; to oblige. You cuddle cutely, and fall asleep.

The next day, you awake to find Zasha&#39;s arms wrapped tight around you. You wake up and blush, but &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; realizes the time. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; needs to get on the road to make it to &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; appointment with Jay, who er... needs his laundry machine repaired. (If the player has learned Zasha&#39;s real job, the implication here might be obvious?)

As &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; drives you back to your car, you&#39;re relieved to see that (a) the snow has melted, and (b) your car is still there. Zasha tows you to a repair shop. You say your farewells to Zasha, who gives you &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; number, and you offer to call. You pull back onto the road, and continue with your trip. Kiss, and wave goodbye.

### The end.

\&gt; [[Restart.|Title Screen]]</tw-passagedata><tw-passagedata pid="42" name="Buy yourself some tea to warm up." tags="" position="550,4275" size="100,100">&lt;% s.got_tea = true; %&gt;

You ask your newfound roommate if &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; wants any tea or coffee.

&quot;I am okay without,&quot; replies Zasha, unlocking the door to the hotel room, &quot;My body is plenty to keep me warm.&quot;

Alright, just for you then.

You stick a dollar into the drink machine, and it produces an insulated disposable cup. The machine slowly pours a hot cup of green tea. You pick it up. It feels wonderful to hold in your chilly paws, but it&#39;s too hot to drink right now.

Zasha opens the door for you.

\&gt; [[Enter the hotel room.|Enter the hotel room. (Tea Route)]]</tw-passagedata><tw-passagedata pid="43" name="Enter the hotel room. (Tea Route)" tags="checkpoint" position="550,4425" size="100,100">You walk inside after Zasha, taking a moment to hang up your jacket. Underneath is a simple gray undershirt which politely covers up your torso. Have we mentioned today, that you&#39;re not wearing pants?

The hotel room is nothing to write home about. There&#39;s a microwave, telephone, bed, singular.

You groan internally as you confirm your suspicions that there&#39;s only one bed in the room. It&#39;s a &lt;%=s.g?&quot;king&quot;:&quot;queen&quot;%&gt;-sized bed, but in this case, it will probably only fit one &lt;%=s.g?&quot;king&quot;:&quot;queen&quot;%&gt;. Obviously, Zasha didn&#39;t expect to share &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; room with a stranger. You glance around for a fold-out couch, but no luck.

Zasha notices you looking at the bed, and seemingly reads your thoughts. &quot;Hm, bed is too small to share, yes? I should have considered this... Zasha will sleep on floor then.&quot;

\&gt; [[No no, I&#39;ll do it!]]</tw-passagedata><tw-passagedata pid="44" name="No no, I&#39;ll do it!" tags="" position="550,4550" size="100,100">You tell Zasha &lt;%=-s.g?&quot;he&quot;:&quot;she&quot;%&gt; has done more than enough. You&#39;ll nab a blanket or two and sleep on the floor.

Zasha nods and gently sits down on the edge of the matress, which creaks as though it&#39;s barely supporting &lt;%-s.g?&quot;him&quot;:&quot;her&quot;%&gt;. &lt;%-s.g?&quot;He&quot;:&quot;She&quot;%&gt; pats the bedspread, offering for you sit next to &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;. You do so. &lt;% if (s.snuggled_up) { %&gt;&lt;%-s.g?&quot;He&quot;:&quot;She&quot;%&gt; opens &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; jacket, and you snuggle up inside.&lt;% } %&gt;

You sit &lt;%- s.snuggled_up ? &#39;cozily&#39; : &#39;awkwardly&#39; %&gt; beside Zasha for a little while, slowly taking little sips of the tea. Mm. It&#39;s now the perfect temperature. Zasha yawns, and you do your best not to stare at &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; giant teeth as &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; does so.

&lt;div.commands&gt;

\&gt; [[Do you want a sip?]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="45" name="Take off your shirt." tags="" position="750,4825" size="100,100"></tw-passagedata><tw-passagedata pid="46" name="Do you want a sip?" tags="" position="550,4675" size="100,100">You offer a sip of your tea to Zasha. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; hesitates at first, but eventually obliges, &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; massive claws very gently taking the cup from you, and having a little sip.

&quot;Mm,&quot; Zasha remarks, &quot;Soothing.&quot;

Zasha gulps loudly. You can almost hear every muscle relaxing in &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; throat as &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; gulps down the liquid.

Zasha delicately reaches to pass the cup back to you. You reach to take it, but &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; claws slip on the rim, and it falls, completely splattering you with a shirtful of warm tea.

&quot;Oh no!&quot; Zasha&#39;s chestnut eyes go wide. &lt;%=s.g?&quot;His&quot;:&quot;Her&quot;%&gt; white face turns beet-red. &quot;Oh dear, Zasha is terribly sorry.&quot; &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; immediately stands, walks to the bathroom, and returns with a towel which &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; immediately begins dabbing on your dripping shirt.

No, you say, allowing the apologetic polar bear to dab your face &lt;%=s.g?&quot;paternalistically&quot;:&quot;maternally&quot;%&gt;, it wasn&#39;t &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; fault. Your heart sinks. You don&#39;t have a spare with you.

Zasha places a claw on your belly. &quot;Does Rabbit need help removing?&quot;

\&gt; [[A-actually...|I don&#39;t have another shirt!]]</tw-passagedata><tw-passagedata pid="47" name="I don&#39;t have another shirt!" tags="" position="550,4800" size="100,100">You blush a deep red, but stammer to produce any words.

&quot;There is no need for to be ashamed, yes? We have all seen naked creature before.&quot; &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; grabs the zipper of &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; coat. &quot;Zasha would disrobe too, if it made you more comfortable?&quot;

&lt;div.commands&gt;

**\&gt; N-no, thank you!**

&lt;/div&gt;

Hesitantly, you remove your shirt. Zasha politely averts &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; eyes while you wrap yourself in a spare blanket.

You look back at Zasha, and the two of you make awkward, prolonged eye contact. You decide to take an early night.

**\&gt; Lie down.**

You do so. The floor is extremely cold.

**\&gt; Ask Zasha for another blanket.**

Zasha is snoring loudly. You try to wake &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;, but it does not work.

\&gt; [[Climb into the bed.]]</tw-passagedata><tw-passagedata pid="48" name="Climb into the bed." tags="" position="975,600" size="100,100">You figure you can just discretely slip into the warm, cozy bed alongside &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;, but in &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; sleep, &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; grabs you and begins to snuggle you against &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; fur.

You&#39;re enjoying the guilty pleasure of having &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; arms wrapped around you, until you feel &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; belly rumbling hard. It&#39;s totally empty, which makes you a bit nervous. Suddenly, the sleeping Zasha opens &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; mouth wide, grips you in &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; claws, and begin stuffing you inside. Oh dear.

Your parents warned you about sleep eatingone of the many reasons never to ever date a predatorbut you assumed it was made-up.

\&gt; [[Cry for help!]]</tw-passagedata><tw-passagedata pid="49" name="Cry for help!" tags="" position="1100,600" size="100,100">You yell out, trying to wake Zasha up, but &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; simply keeps sleep-swallowing you until you&#39;re deep inside &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; belly. It immediately beings to digest you. In utter shock, you fall unconscious.

&quot;Mmmm...&quot;

### The End.

\&gt; [[Epilogue.|Ending: Digestion regret]]

\&gt; &lt;a0 onclick=&quot;bunny.restart()&quot;&gt;Restart.&lt;/a&gt;</tw-passagedata><tw-passagedata pid="50" name="Jump down their throat." tags="warm" position="1600,1625" size="100,100">*CW: Oral Vore. Saliva. Fatal digestion.*

Something strange takes ahold of you, and at that moment, you cannot bear being outside this huge, sexy predator&#39;s maw for one second longer.

Through the car window, you grab hold of &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; lips, pull &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; jaw open, and attempt to force your face against &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; hot, slobbery tongue, so you can wriggle down &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; esophagus and become part of that warm, pudgy belly.

\&gt; [[Continue.|Jump down their throat II.]]</tw-passagedata><tw-passagedata pid="51" name="Jump down their throat II." tags="cold" position="1600,1750" size="100,100">&quot;Hrk!&quot; The bear suddenly gags, and grabs you by the scruff of your neck to yank you out of &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; mouth, coughing. As you awkardly wipe the spittle from your fur, the polar bear looks at you bewildered. &quot;Kafkaf kaf! Ack! Wh-what?&quot;

Sorry!! you say immediately, you&#39;re not sure what came over you there, that was completely-

The polar bear interrupts, looking you straight in the eyes with furrowed brows and much seriousness in &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; voice: &quot;Rabbit, you wish for Zasha to eat you?&quot;

\&gt; [[Oh, yes please!|Oh, yes please!]]

\&gt; [[N-no, of course not!]]</tw-passagedata><tw-passagedata pid="52" name="N-no, of course not!" tags="cold" position="1600,1875" size="100,100">You take a moment to think about it. *Do* you want to be eaten?

No, no! Of course you don&#39;t. Why would you? That would be insane, right? Who would ever *want* that to happen to them?

&quot;Actually,&quot; the bear interjects, &quot;Zasha is aware of many with sexual fetish for being-&quot;

Right, yeah, but you&#39;re not one of *those* weirdos. You swear.

Zasha wets &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; mouth and replies, &quot;You are sure? Zasha would not be judgemental if Rabbit was... curious.&quot;

&lt;div.commands.important&gt;

\&gt; [[No, I&#39;m absolutely sure.]]

\&gt; [[P-please swallow me whole!|Oh, yes please!]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="53" name="No, I&#39;m absolutely sure." tags="cold" position="1600,2000" size="100,100">You shake your head vehemently no. You&#39;re not sure what came over you just now. But you don&#39;t want to be eaten.

&quot;Okay then,&quot; the bear nods, clears &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; throat. &quot;So, er, car is broken down? You require assistance?&quot;

\&gt; [[Yes, actually...|Yes, I do need help actually...]]</tw-passagedata><tw-passagedata pid="54" name="Oh, yes please!" tags="" position="1800,1725" size="100,100">Your ears stand straight up with excitement. Unlike most bunnies, you&#39;ve always been &quot;curious&quot; as to what being swallowed is like, but never really admitted it to yourself.

You say that you would love to be eaten, um, but you understand if &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt;&#39;s not interested, of course.

The polar bearwho you presume is Zashablushes furiously beneath &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; white fur. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; looks at youand your bodywith a renewed interest.

&quot;...Rabbit wishes for protection from cold?&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; asks.

Yes, you say. You want to be wrapped up in warmth. You want to feed &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; huge belly and fatten it up with yourself.

Zasha narrows &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; eyes. &quot;Rabbit is absolutely sure?&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; reiterates, as if trying to make sure &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; has not misunderstood or misinterpreted you.

\&gt; [[Yes, a thousand times yes!!]]</tw-passagedata><tw-passagedata pid="55" name="Yes, a thousand times yes!!" tags="warm" position="1800,1850" size="100,100">Yes, yes, you say. You&#39;re almost sweating through your shirt with anticipation. You wonder if Zasha can smell it.

Zasha considers. &quot;This rabbit is a strange one. However, Zasha is hungry, and thought of swallowing has brought about some... urges. Zasha will oblige with Rabbit&#39;s request.&quot;

Your name is Juniper, you say. It hardly seems right to ask someone to eat you without telling them your name.

&quot;Juniper. Hm. This is a pleasant name. Thank you Juniper, Zasha is grateful for this meal.&quot; &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; licks &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; lips, seemingly a little excited &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;self.

Zasha pokes &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; enormous head into your driver-side window, shuts &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; eyes, and opens &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; mouth up wide. &lt;%=s.g?&quot;His&quot;:&quot;Her&quot;%&gt; teeth, tongue, and throat are just inches from your face. You gaze into that pink, slimy entrance in disbelief. It&#39;s so... big. So warm. So inviting.

You spend a few seconds merely gazing in awe at your destination. Zasha briefly peeks one eye open, as if &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt;&#39;s wondering what&#39;s taking you so long.

What will you do?

\&gt; [[Climb inside &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; mouth.|Climb inside Zasha&#39;s mouth.]]</tw-passagedata><tw-passagedata pid="56" name="Climb inside Zasha&#39;s mouth." tags="vore checkpoint" position="1800,1975" size="100,100">You eagerly stick one paw, then the other, into the bear&#39;s awaiting maw. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; guides them into &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; throat, and swallows them effortlessly. A second gulp tugs at your arms, and pulls you face-first against &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; slobbery tongue, which quickly gets to work tasting your face, and coating your fur in &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; saliva.

Experimentally, you try to pull one of your paws back out, but it&#39;s being gripped tightly by Zasha&#39;s esophagus. Looks like no turning back now.

Zasha&#39;s breath is warm and humid as it blasts your face. Surprisingly, it doesn&#39;t smell very bad inside &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; mouth. In fact, &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; dental hygiene is spotless. The sharp teeth framing &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; tongue are almost as white as &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; fur. You only have a moment to appreciate this before &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; suddenly lurches &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; head forward, forcing your head and ears to the back of &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; throat.

You stare in amazement as your face approaches the dark warmth of &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; gullet.

\&gt; [[Th-thank you...]]</tw-passagedata><tw-passagedata pid="57" name="Th-thank you..." tags="vore" position="1800,2100" size="100,100">You murmur thanks at Zasha, unsure if &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; can hear you.

The bear nods and swallows, squeezing your head and ears into the tight wet tube of &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; esophagus. Powerful arms wrap around your middle, and lift you into the air so &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; can take in your body more easily. Zasha licks and slobbers at your torso, not even bothering to remove your clothes.

Zasha&#39;s throat is like a tight blanket wrapping you from every side, covering your mouth and slathering you in what feels like gallons of drool.

You&#39;re officially food now, and it feels *amazing*.

&lt;div.commands&gt;

\&gt; [[Enter stomach.|Enter stomach. (Vore Route 1)]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="58" name="Enter stomach. (Vore Route 1)" tags="vore" position="1800,2225" size="100,100">It&#39;s so warm inside the bear&#39;s gullet. Not surprising, considering all &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; layers of fat. Your small body sails over Zasha&#39;s lips and effortlessly slides down into &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; belly. It&#39;s hard to breathe inside &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; throat, but that changes soon enough.

With a *shlorp*, you emerge in the clenching confines of Zasha&#39;s stomach. Your fur is immediately coated in clear slimy enzymes. Moving around is difficult in such a small space, but you eventually manage to remove your shirt and jacket, which have been thoroughly soiled. You are now a completely nude rabbit, inside the dank tummy of a predator. It&#39;s everything you imagined.

Moments later, you feel the pressure of a huge paw feeling for your presence through the fat stomach walls.

&quot;Juniper is doing okay in there?&quot; Zasha asks, &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; voice booming from every direction.

\&gt; [[Yes, wonderful!]]</tw-passagedata><tw-passagedata pid="59" name="Yes, wonderful!" tags="vore" position="1800,2350" size="100,100">You shout approvingly at the top of your little rabbit lungs, attempting to make your voice heard through the thick insulation surrounding you from all sides. As you close your mouth, you taste a little bit of Zasha&#39;s saliva on your lips.

Zazha opens &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; mouth to reply, but is interrupted by a deep, guttural belch. Your body must&#39;ve displaced a lot of air. As the burp escapes Zasha&#39;s lips, &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; walls get a little bit tighter around you. &quot;That is, *urp*, good to hear,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says, &quot;Juniper made for delicious meal.&quot; The bear affectionately rubs &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; belly and says, &quot;I am on way to hotel nearby. You will come along with Zasha for night? Return to car in morning?&quot;

**\&gt; Perfect...**

You rub the surrounding stomach walls approvingly.

Zasha pulls &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; head out of your car window with a satisfied smile. Your surroundings jiggle and bounce a little as &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; stands up. Zasha carefully rolls the window back up, takes your little handbag, and locks the car door.

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; clutches &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; gut to hold you steady, and trudges back through the snow to &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; truck. The engine roars to life. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; pats your outline, and says, &quot;Okay then, rabbit. You are ready to go?&quot;

&lt;div.commands&gt;

\&gt; [[Get comfy.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="60" name="Get comfy." tags="vore" position="1800,2475" size="100,100">&lt;div.important&gt;
This route is unfinished! It&#39;s playable, but is still written as an outline and may be missing content.
&lt;/div&gt;

You&#39;re curled up uncomfortably, and decide to reposition yourself slightly.

&quot;Oof...&quot; Zasha grunts and groans slightly as you move around inside &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;. S-sorry! you say, you&#39;re just trying to- Woah! Your paw slips and you accidentally kick hard into the stomach walls.

&quot;Mmmmmmmnghh!&quot; Zasha suddenly lets out an erotic moan. Awkward silence. &quot;Oh dear- I do not wish to cause rabbit discomfort, but these movements are making Zasha feel... pleasurable. Does Juniper wish to be regurgitated?&quot;

**\&gt; I don&#39;t mind, actually...**

Well, um...

Zasha begins to reach for a bottle of anti-digestion pills.

You tell Zasha that you don&#39;t mind. In fact, you admit, you&#39;re experiencing similar... pleasurable feelings. You like being &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; food.

&quot;Hmph?&quot; Zasha says. You think &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; might be blushing. &quot;Zasha is happy to hear this. Well then, let us embark before storm gets worse.&quot;

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; conspicuously puts the anti-digestion pills back, and starts driving.

**\&gt; A bumpy ride.**

Zasha&#39;s gut bounces and sloshes harmlessly around you as the truck moves.

There&#39;d probably be a description of the passing scenery here, if you weren&#39;t completely blind inside the dank, dark, sexy stomach of a polar bear.

You hear Zasha stop the car. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; enters, hefting &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; huge gut inside. The concierge gives &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt; a weird look, but says nothing.

\&gt; [[Enter the hotel room. (Willing Oral Route)]]</tw-passagedata><tw-passagedata pid="61" name="Enter the hotel room. (Willing Oral Route)" tags="vore checkpoint" position="1800,2625" size="100,100">**\&gt; Can I come out now?**

Zasha, exhausted, replies &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt;&#39;ll let you out tomorrow morning. What!? You&#39;ll be going through &quot;the natural way.&quot; More gentle on stomach, says Zasha. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; seems to be teasing you. &quot;Besides, hotel is much too cold for rabbit,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says smirking, &quot;Zasha must keep warm.&quot;

**\&gt; No! Spit me up now!**

You try to fight it, but you&#39;re in no position to bargain. Zasha happily dozes off to sleep. You spend the night in Zasha&#39;s belly. You&#39;re becoming too tired to fight back. You doze off for a few hours.

A few hours later, you awake to realize that Zasha is still sleeping, and &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; stomach is starting to digest you.

\&gt; [[Wake &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt; up.|Wake Zasha up.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="62" name="Wake Zasha up." tags="" position="1750,2775" size="100,100">You kick and yell, but it doesn&#39;t take. Your predator snores and turns onto &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; belly.

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; only murmurs in &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; sleep, &quot;Zasha... will let rabbit out... tomorrow.&quot;

&lt;div.commands.important&gt;

\&gt; [[Await warm and gurgly death.]] *(Route 2a: Fatal digestion)*

\&gt; [[Thrash and struggle for your life!]] *(Route 2b: Non-fatal)*

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="63" name="Await warm and gurgly death." tags="vore" position="1800,2925" size="100,100">// TODO:

You resign to your fate of being accidentally digested.

\&gt; [[The next day...|Ending: Digestion regret]] *(Post-vore scat)*

\&gt; &lt;a0 onclick=&quot;bunny.restart()&quot;&gt;Restart.&lt;/a&gt;</tw-passagedata><tw-passagedata pid="64" name="Ending: Digestion regret" tags="" position="1775,3700" size="100,100">*CW: Post-Vore scat.*

The next day, Zasha wakes up with a huge belly full of digested rabbit. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; is quite upset over this, having failed to protect an innocent creature, but is gradually corrupted by the carnal feelings of power which predation gives &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;. It&#39;s not the first time, and &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; stoically concludes there was nothing &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; could have done to stop it.

You and your belongings are discretely flushed in the hotel toilet as a slurry of bones and rabbit fur. Zasha starts downtown.

### The End.

\&gt; &lt;a0 onclick=&quot;bunny.restart()&quot;&gt;Restart.&lt;/a&gt;</tw-passagedata><tw-passagedata pid="65" name="Thrash and struggle for your life!" tags="" position="1675,2925" size="100,100">*CW: Regurgitation.*

You expend all of your effort, and manage to wake Zasha from &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; slumber, who realizes that &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; fell asleep. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; immediately rushes to the bathroom, and horks you up into the tub. The authors don&#39;t have a vomit fetish, so they leave it up to the imagination.

You take a long shower, and you think about the choices that lead you to this brush with death. You towel off, and return to the room with a large towel covering your chest and waist. Zasha tries to apologize for nearly digesting you.

&lt;div.commands.important&gt;

\&gt; [[Actually, th-that was kind of hot.]] *(Lewd ending)*

\&gt; [[Just go to bed.]] *(Unlewd ending)*

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="66" name="Actually, th-that was kind of hot." tags="" position="725,850" size="100,100">You stop &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;, and say that being nearly digested made you so unbelievably horny. Zasha is bemused, but reciprocates.

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; removes &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; jacket, and allows.</tw-passagedata><tw-passagedata pid="67" name="Just go to bed." tags="" position="850,850" size="100,100">You walk past Zasha, and  on the floor, still coping with the trauma of almost being digested.

The next day, Zasha wordlessly drives you back to your car. Your cell is working again, and the snow is gone. You try to talk, but can&#39;t think of anything to say.

\&gt; &lt;a0 onclick=&quot;bunny.restart()&quot;&gt;Restart.&lt;/a&gt;</tw-passagedata><tw-passagedata pid="68" name="Ending: Somewhat awkward" tags="" position="975,850" size="100,100">\&gt; &lt;a0 onclick=&quot;bunny.restart()&quot;&gt;Restart.&lt;/a&gt;</tw-passagedata><tw-passagedata pid="69" name="Press for more information." tags="cold" position="1050,2175" size="100,100">*CW: Anal Vore. Masturbation. Rimming.*

You can clearly tell that Zasha is lying about &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; job. You tell &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt; so outright. What does &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; *really* do for a living?

Zasha seems taken aback, &quot;I... I apologize for this untruthfulness. Zasha works in an er... &#39;disreputable&#39; field, and did not want to make rabbit nervous.&quot;

Disreputable field? Oh god, does &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; work for the mob? Does Northaven *have* a mob? Are you being kidnapped??

&quot;No, no!&quot; the bear says, &quot;Nothing like that! Zasha travels around to star in... unusual freelance films.&quot;

What films, you ask? Maybe you&#39;ve seen some of them.

Zasha shifts uncomfortably. &quot;Films of... er... sexual swallowing,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says.

&lt;div.commands&gt;

\&gt; [[Oh. *Ooooooh.*|Oh. Ooooooh.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="70" name="Oh. Ooooooh." tags="" position="1050,2300" size="100,100">&lt;%
console.debug(`Set s.knows_zasha_does_vorno from ${s.knows_zasha_does_vorno} to true.`)
s.knows_zasha_does_vorno = true; %&gt;

Oh, you say, cheeks suddenly turning red. *Those* films.

Zasha is referring to internet videos of consensual prey being devoured. *Vornography*. It&#39;s legal, although slightly frowned upon. They&#39;re chiefly aimed at predators who don&#39;t otherwise have a healthy way of expressing their desires.

You&#39;re ashamed to think that you&#39;ve actually seen quite a lot of those films on sites like TummyTube, GrumbleX, and &lt;%=s.g?&quot;ButtBrothers&quot;:&quot;SwallowSisters&quot;%&gt;.com. You never thought you&#39;d be in the same *post-code* as one of the &lt;%=s.g?&quot;actors&quot;:&quot;actresses&quot;%&gt;, much less riding alone in a car with one.

&lt;div.commands&gt;

\&gt; [[S-so, you eat people for a living?]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="71" name="S-so, you eat people for a living?" tags="cold" position="1150,2400" size="100,100">&quot;Yes,&quot; Zasha says, struggling to make eye-contact, &quot;but only with strict consent, of course!&quot;

A-and no digestion, right?

Zasha pauses for slightly too long to be reassuring. &quot;Er, usually, yes.&quot;

Your face flushes. *Usually*? &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt;&#39;s d-done it? This bear&#39;s belly, just a few feet from you, has dissolved prey into its fat. You never watched much in *that* category, but the thought fills you with equal parts fear and arousal.

&lt;div.commands.important&gt;

\&gt; [[...Can you eat me?]]

\&gt; [[C-cool! A-anyways...]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="72" name="C-cool! A-anyways..." tags="cold" position="975,2525" size="100,100">Now that you have this unpleasant knowledge haunting the back of your mind, you decide to do the normal thing, and change the subject as quickly as possible.

S-some weather, huh?

Zasha says, &quot;I assure you rabbit, Zasha eats no one without their permission. This would be terrible and immoral... You will not share this with hotel staff, yes?&quot;

You nod. You&#39;d rather forget all about Zasha&#39;s innate capacity to swallow and wholly digest people your size. The two of you ride together in silence for a minute or so. &lt;%= story.render(&quot;Arrive at the hotel.&quot;)%&gt;

&lt;div-&gt;[[Arrive at the hotel.]]&lt;/div&gt;</tw-passagedata><tw-passagedata pid="73" name="...Can you eat me?" tags="cold" position="1125,2525" size="100,100">Your libido gets the better of you. You stammer out a request which feels extremely weird to say out loud. You ask the bear if &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; can eat you.

Zasha seems taken aback. &quot;This does not... scare you? Usually Zasha&#39;s partners, er, prey, are quite nervous.&quot;

No, you say, you&#39;re actually quite curious. N-no digestion, of course!

&quot;Ah. Prey do tend to calm down when reassured they will not be digested... Zasha is not shooting until tomorrow evening, and rabbit does present a tempting offer... Does rabbit wish swallowing, or other options?&quot;

There are *other* options?

Zasha smiles uneasily. &quot;Yes, sometimes Zasha is involved in... *specialty* scenes. Taking prey into private parts, or um, anal hole...&quot;

\&gt; [[Anal? You can do that?]]</tw-passagedata><tw-passagedata pid="74" name="Anal? You can do that?" tags="cold" position="1125,2650" size="100,100">You&#39;re somewhat disbelieving of this. You knew some predators were capable of &quot;anal vore&quot;, but you learned in Biology that it was a very rare skill.

&quot;Yes,&quot; Zasha replies, &quot;Zasha is big bear, yes. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; can consume prey through this hole. Can even squeeze through intestines and into stomach to be, er, regurgitated.&quot;

You listen intently, equal parts disgusted, terrified, and amazed.

&quot;This requires much practice,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; says, seemingly rather proud.

&lt;div.commands&gt;

\&gt; [[Would you mind... um... showing me?]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="75" name="Would you mind... um... showing me?" tags="cold" position="1125,2775" size="100,100">Zasha doesn&#39;t take &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; eyes off the road, but you can see a mischievous smirk growing on &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; face.

&quot;Yes,&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; replies &quot;Zasha can do this. Wait until hotel, okay? We are almost there.&quot;

You nod, now very excited. You hardly expected this night would end with you being devoured through a polar bear&#39;s asshole. It&#39;s almost like a scene in those erotic fanfictions which... *other* people... seem to be very into. So you&#39;ve heard, anyway.

Zasha keeps driving. Scenery whizzes past. Eventually &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; turns off the road, and into the parking lot of the roadside hotel &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt;&#39;s staying at tonight. You climb out of the truck, and groan as the icy snow burns your pawpads.

You&#39;re about to complain, when Zasha suddenly scoops you into &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; arms like a baby.

&lt;div.commands&gt;

\&gt; [[Wh-what gives?]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="76" name="Wh-what gives?" tags="" position="1125,2900" size="100,100">Zasha snuggles you close to &lt;%=s.g?&quot;his chest&quot;:&quot;her bosom&quot;%&gt;, and smiles. &quot;Rabbit is Zasha&#39;s toy now. Zasha does not like cold toy.&quot;

You blush, but accept &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; affectionate teasing as &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; carries you into the building, setting you down in the lobby while &lt;%s.g?&quot;he&quot;:&quot;she&quot;%&gt; talks to the concierge to get a room key. As a rabbit, you&#39;re somewhat used to people treating you like a child, but Zasha is treating you like *&lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt;* child, a child &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; intends to consume anally. Freud would have a field day with this.

With keycards in hand, Zasha leads you down the hall, walking with &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; tail in the air, and &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; butt pointed directly at you. Your eyes fix on that gigantic furry ass. It sways slightly as &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; saunters ahead. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt;&#39;s definitely teasing you. You follow &lt;%=s.g?&quot;him&quot;:&quot;her&quot;%&gt;.

From the front desk, the concierge winks at you and gives a thumbs up. You smile back, nervously.

&lt;div.commands&gt;

\&gt; [[Enter the hotel room.|Enter the hotel room. (Anal Vore Route)]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="77" name="Enter the hotel room. (Anal Vore Route)" tags="checkpoint" position="1125,3025" size="100,100">&lt;div.important&gt;
This route is unfinished! It&#39;s playable, but is still written as an outline and may be missing content.
&lt;/div&gt;

It&#39;s demonstration time.

Zasha instructs you &quot;Remove clothes,&quot; and wait while &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; goes back to the car to get some supplies.

**\&gt; Get undressed.**

You remove your shirt and jacket. God, you just feel so *exposed* and vulnerable like this. You&#39;re nearly shaking with excitement.

Zasha returns with the metal toolbox from the car. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; shows you some anti-digestion pills, plus a huge bottle of strawberry flavored edible lube.

You say that you&#39;ve never done this before. Sh-should you have a safeword?

&quot;Safe word? Like what?&quot;

\&gt; &lt;a0 data-passage=&quot;The safe word is...&quot;
onclick=&quot;story.state.safeWord=&#39;Pineapple&#39;;&quot;&gt;Pineapple!&lt;/a&gt;

\&gt; &lt;a0 data-passage=&quot;The safe word is...&quot;
onclick=&quot;story.state.safeWord=&#39;Sassafrass&#39;;&quot;&gt;Sassafrass!&lt;/a&gt;

\&gt; &lt;a0 data-passage=&quot;The safe word is...&quot;
onclick=&quot;story.state.safeWord = &#39;Idiosyncratic&#39;; story.state.weirdSafeWord = true;&quot;&gt;Idiosyncratic!&lt;/a&gt;

&lt;div-&gt;
\&gt; [[The safe word is...]]
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="78" name="The safe word is..." tags="" position="1125,3150" size="100,100">&lt;% s.safeWord = s.safeWord || &quot;&quot;; %&gt;

&quot;&lt;%-s.safeWord%&gt;&lt;%-s.weirdSafeWord ? &#39;?&#39; : &#39;,&#39; %&gt;&quot; Zasha repeats, &quot;&lt;%-either(&quot;Okay&quot;, &quot;Alright&quot;, &quot;Yes&quot;)%&gt;. Say this, and Zasha will stop what &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; is doing and help Rabbit out.&quot;

Younakedbashfully shy away from Zasha, but &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; gently dominates you, cupping your chin and teasing your crotch. All vornography moves.

W-wow, you two are really doing this.

&lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; then hands you the bottle of lube, gets up on the bed on all fours, and instructs you to spread &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; cheeks, and lube up &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; asshole.

&lt;div.commands&gt;

\&gt; [[Lube up &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; hole.|Lube up Zasha&#39;s hole.]]

\&gt; [[Use your tongue.]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="79" name="Lube up Zasha&#39;s hole." tags="" position="1225,3275" size="100,100">You squirt a load of &quot;Strawberry Lik-n-Stik Edible Lube&quot; onto your cupped paw, and delicately smear it all over Zasha&#39;s asshole.

&quot;Rabbit will need to get it deeper...&quot; &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; teases.

Experimentally, you push your paw against the pucker, and it effortlessly slides in, helping coat your destination with lube.

&quot;Good,&quot; Zasha purrs, gently clenching to pull your paw deeper. &quot;Now, the other.&quot;

You catch on to &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; game, and slip your other paw in as well, using your body to steady yourself as you gradually push them in up to your elbows, then halfway up your shoulder. You&#39;re soon hunched over the bed, with Zasha&#39;s ass cheeks eclipsing your vision.

Zasha&#39;s furry tail is sticking straight up. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; says, &quot;Well rabbit, this is it. Take deep breath now, yes?&quot;

\&gt; [[Press your face into &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; asshole.|Press your face into Zasha&#39;s asshole.]]</tw-passagedata><tw-passagedata pid="80" name="Use your tongue." tags="" position="1100,3275" size="100,100">As you hold Zasha&#39;s cheeks apart and gaze into the hole betwixt, you can&#39;t help yourself. You lean in begin to swirl your tongue around &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; huge puckered asshole. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; immediately responds with a moan, &lt;%=s.g?&quot;his cock twitching slightly between his legs.&quot;:&quot;her asshole clenching and releasing.&quot;%&gt;. &quot;Rabbit could not help itself, yes? Mm, this is not bad...&quot; You keep going for a little while, inhaling deep lungfuls of bear musk.

Finally, Zasha says, &quot;Rabbit *will* need to use more lube to get inside of Zasha.&quot;

\&gt; [[Lube up &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; hole.|Lube up Zasha&#39;s hole.]]</tw-passagedata><tw-passagedata pid="81" name="Press your face into Zasha&#39;s asshole." tags="vore" position="1125,3450" size="100,100">&lt;% s.safeWord = s.safeWord || &quot;&quot;; %&gt;

You shlorp your nose into Zasha&#39;s thick ass. It&#39;s dripping with sweat as you fold your ears behind your head, and press forward.. The sensation of forcing your face into that tight ring, and having it stretch to accept you, is utterly surreal.

\&gt; [[Breathe deep.]]</tw-passagedata><tw-passagedata pid="82" name="Breathe deep." tags="" position="225,1100" size="100,100">The smell is intoxicating, a powerful musk, mixed with strawberries. You travel past rectum, and into &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; colon. Your ears lead the way as you keep travelling deeper. It&#39;s magical.

\&gt; [[Is this too deep?]]</tw-passagedata><tw-passagedata pid="83" name="Is this too deep?" tags="" position="350,1100" size="100,100">Zasha moans and urges you deeper. &lt;%=s.g?&quot;His&quot;:&quot;Her&quot;%&gt; paws delicately guide your bulge through &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; intestines.

It starts to become a little tight in here, and you find yourself struggling to breathe.

\&gt; [[&lt;%-s.safeWord%&gt;! &lt;%-s.safeWord%&gt;!!|Safeword! Safeword!!]]</tw-passagedata><tw-passagedata pid="84" name="Safeword! Safeword!!" tags="" position="475,1100" size="100,100">You&#39;re losing oxygen. You wiggle your tightly bound feet with displeasure, and call out for help. Your voice is muffled, but Zasha seems to only push you deeper! You can hear &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; heart pounding around you now.

\&gt; [[&lt;%-s.safeWord.slice(0, 4)%&gt;...|Safe...]]</tw-passagedata><tw-passagedata pid="85" name="Safe..." tags="" position="600,1100" size="100,100">You feel yourself become woozy. Zasha&#39;s upper intestine pulsates indifferently around you. You feel consciousness... beginning... to...

*GASP*. Your head pokes through a sphincter into Zasha&#39;s stomach, a dark dank cavern.

You feel your feet disappear beneath Zasha&#39;s tail. Zasha sits down, and delicately caresses your outline. &quot;I-is rabbit okay?&quot; Zasha swallows several anti-digestion tablets, and they plop and fizz into the surrounding stomach juices.

\&gt; [[Y-yeah. I&#39;m okay.]]</tw-passagedata><tw-passagedata pid="86" name="Y-yeah. I&#39;m okay." tags="" position="725,1100" size="100,100">You&#39;re fine, you say. Actually, it made you feel kind of... alive. You look down at your lower half, now also inside the stomach. *Very* alive.

Zasha, too, is feeling a great deal of physical pleasure. Both of your libidos at their peak from the undeniably sexual experience of carnivorous satisfaction, you both (optionally) masturbate.

// TODO: jerk-off descriptions
// Might need separate passages per gender.

\&gt; [[Yess!]]</tw-passagedata><tw-passagedata pid="87" name="Yess!" tags="" position="850,1100" size="100,100">// TODO: Orgasm description.

Satisfied with the orgasm, the two of you fall asleep.

&lt;div.commands&gt;

\&gt; [[The next day...|Ending: Morning after]]

&lt;/div&gt;</tw-passagedata><tw-passagedata pid="88" name="Ending: Morning after" tags="" position="1125,3600" size="100,100">You wake up in the morning, being squeezed out of the bear&#39;s asshole, and into a bathtub. Yuck.

You gratefully return to your car, unable to look Zasha in the eye after spending multiple hours in &lt;%=s.g?&quot;his&quot;:&quot;her&quot;%&gt; large intestine. &lt;%=s.g?&quot;He&quot;:&quot;She&quot;%&gt; seems a little bashful about almost killing you, but the two of you are on good terms. Zasha tows your car to a repair shop, and waves you off. As &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; leaves, &lt;%=s.g?&quot;he&quot;:&quot;she&quot;%&gt; writes down an email address, and winks, asking if you want to do it again some time. A shiver goes down your spine.

### The end.

\&gt; &lt;a0 onclick=&quot;bunny.restart()&quot;&gt;Restart.&lt;/a&gt;</tw-passagedata></tw-storydata>
</div>
</body>
</html>